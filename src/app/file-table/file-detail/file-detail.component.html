<div class="container">
  <app-header></app-header>
  <h1 class="text-center">{{fileId}}</h1>
  <dl class="dl-horizontal">
    <dt>File name:</dt> <dd>{{ file?.name }}</dd>
    <dt>Release date:</dt> <dd>{{file?.releaseDate}}</dd>
    <dt>Update date:</dt> <dd>{{file?.updateDate}}</dd>
    <dt>Organism:</dt>
    <dd>
      <app-robust-link prefix="https://www.ebi.ac.uk/ols/terms?iri=" [link]="file?.species?.ontologyTerms" [text]="file?.species?.text"></app-robust-link>
    </dd>
    <dt>Specimen:</dt>
    <dd>
      <app-robust-link prefix="../specimen/" [link]="file?.specimen" [text]="file?.specimen"></app-robust-link>
    </dd>
    <div *ngIf="file?.organism">
      <dt>BioSample ID:</dt>
      <dd>
        <app-robust-link prefix="../organism/" [link]="file?.organism" [text]="file?.organism"></app-robust-link>
      </dd>
    </div>
    <dt>File size:</dt> <dd>{{file?.size}} ({{file?.readableSize}})</dd>
    <dt>Archive:</dt> <dd>{{file?.archive}}</dd>
    <dt *ngIf="file?.readCount">Read count:</dt> <dd>{{file?.readCount}}</dd>
    <dt *ngIf="file?.baseCount">Base count:</dt> <dd>{{file?.baseCount}}</dd>
    <dt *ngIf="file?.submission">Submission:</dt>
    <dd>
      <app-robust-link prefix="https://www.ebi.ac.uk/ena/data/view/" [link]="file?.submission" [text]="file?.submission"></app-robust-link>
    </dd>
    <dt *ngIf="file?.experiment?.accession">Experiment:</dt>
    <dd>
      <app-robust-link prefix="https://www.ebi.ac.uk/ena/data/view/" [link]="file?.experiment?.accession" [text]="file?.experiment?.accession"></app-robust-link>
      <button type="button" class="btn btn-info btn-xs" (click)="ngxSmartModalService.getModal('myModal').open()">Open experiment info</button>
    </dd>
    <dt *ngIf="file?.study?.accession">Study:</dt>
    <dd>
      <app-robust-link prefix="../dataset/" [link]="file?.study?.accession" [text]="file?.study?.accession"></app-robust-link>
    </dd>
    <dt *ngIf="file?.study?.title">Study title:</dt> <dd>{{file?.study?.title}}</dd>
    <dt *ngIf="file?.run?.accession">Run:</dt>
    <dd>
      <app-robust-link prefix="https://www.ebi.ac.uk/ena/data/view/" [link]="file?.run?.accession" [text]="file?.run?.accession"></app-robust-link>
    </dd>
    <dt *ngIf="file?.run?.platform">Platform:</dt> <dd>{{file?.run?.platform}}</dd>
    <dt *ngIf="file?.run?.instrument">Instrument:</dt> <dd>{{file?.run?.instrument}}</dd>
    <dt *ngIf="file?.run?.centerName">Center name:</dt> <dd>{{file?.run?.centerName}}</dd>
    <dt *ngIf="file?.run?.sequencingDate">Sequencing date:</dt><dd>{{file?.run?.sequencingDate}}</dd>
    <dt *ngIf="file?.run?.sequencingLocation">Sequencing location:</dt> <dd>{{file?.run?.sequencingLocation}}</dd>
    <dt *ngIf="file?.run?.sequencingLatitude">Sequencing latitude:</dt> <dd *ngIf="file?.run?.sequencingLatitude">{{file?.run?.sequencingLatitude}} (decimal degrees)</dd>
    <dt *ngIf="file?.run?.sequencingLongitude">Sequencing longitude:</dt> <dd *ngIf="file?.run?.sequencingLongitude">{{file?.run?.sequencingLongitude}} (decimal degrees)</dd>

    <div *ngIf="file?.paperPublished === 'true'">
      <dt>Published papers: </dt>
      <dd>
        <ng-container *ngFor="let paper of file.publishedArticles">
          <a [routerLink]="['/article', paper.pubmedId]">{{paper.pubmedId}} </a>
        </ng-container>
      </dd>
    </div>
  </dl>
  <app-run-files [runId]="file?.run?.accession" *ngIf="file?.run?.accession"></app-run-files>
  <div class="alert alert-danger" *ngIf="error"><p>{{ error }}</p></div>
  <ngx-smart-modal #myModal identifier="myModal" class="nsm-dialog-animation-fade" width="200%" customClass="msg-modal">
    <h3>{{file?.experiment?.accession}}</h3>
    <hr>
    <ng-container *ngIf="experiment && fieldNames">
      <ng-container *ngFor="let key of objectKeys(fieldNames)">

        <ng-container *ngIf="experiment.hasOwnProperty(key) && checkIsObject(experiment[key])">
          <ng-container *ngIf="experiment[key].hasOwnProperty('filename')">
            <p>
              <b>{{fieldNames[key]}}: </b> <br>
              <app-robust-link [link]="experiment[key]['url']" [text]="experiment[key]['filename'] | slice:0:62"></app-robust-link>
            </p>
          </ng-container>
          <ng-container *ngIf="experiment[key].hasOwnProperty('text')">
            <p>
              <b>{{fieldNames[key]}}: </b> <br>
              {{experiment[key]['text']}} ({{experiment[key]['unit']}})
            </p>
          </ng-container>
        </ng-container>

        <ng-container *ngIf="experiment.hasOwnProperty(key) && !checkIsObject(experiment[key])">
          <p>
            <b>{{fieldNames[key]}}: </b> <br>
            {{experiment[key]}}
          </p>
        </ng-container>

      </ng-container>
    </ng-container>
    <button (click)="myModal.close()" type="button" class="btn btn-success">Close</button>
  </ngx-smart-modal>
</div>
