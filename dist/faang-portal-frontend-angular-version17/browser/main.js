"use strict";(self.webpackChunkfaang_portal_frontend_angular_version17=self.webpackChunkfaang_portal_frontend_angular_version17||[]).push([["main"],{3823:(C,it,f)=>{var P=f(436),t=f(7404);const w_production=!1,w_cookieDomain="localhost",w_host="https://api.faang.org/",w_relatedProjectsHost="https://raw.githubusercontent.com/FAANG/comm-data-portal-projects/master/projects/";var rt=f(3719),S=f(8610),J=f(1249);class N{constructor(){}ngOnInit(){}static#t=this.\u0275fac=function(s){return new(s||N)};static#e=this.\u0275cmp=t.VBU({type:N,selectors:[["app-footer"]],decls:14,vars:0,consts:[[1,"footer","font-small","mdb-color","lighten-3","pt-4"],[1,"container-fluid","text-center","text-md-left"],["fxLayout","row","fxlayout.lt-sm","column","fxLayoutGap","2%"],["fxFlex","10","fxFlex.lt-sm","100"],["src","../../../assets/1200px-Flag_of_Europe.svg.png","alt","EU logo","width","90","height","50",1,"img-fluid"],["fxFlex","90","fxFlex.lt-sm","100"],["href","https://ec.europa.eu/programmes/horizon2020/"],["href","https://bbsrc.ukri.org/"]],template:function(s,i){1&s&&(t.j41(0,"footer",0)(1,"div",1)(2,"div",2)(3,"div",3),t.nrm(4,"img",4),t.k0s(),t.j41(5,"div",5)(6,"p"),t.EFF(7," The FAANG Data Coordination Centre has received funding from the "),t.j41(8,"a",6),t.EFF(9,"European Union\u2019s Horizon 2020"),t.k0s(),t.EFF(10," research and innovation program under Grant Agreement Nos. 815668, 817923 and 817998, and also from the "),t.j41(11,"a",7),t.EFF(12,"Biotechnology and Biological Sciences Research Council"),t.k0s(),t.EFF(13," under Grant Agreement No. BB/N019563/1. "),t.k0s()()()()())},styles:[".page-footer[_ngcontent-%COMP%]{position:fixed;bottom:0;height:100px;width:100%}.mdb-color[_ngcontent-%COMP%]{background-color:#f7f7f7}a[_ngcontent-%COMP%]{color:#4682b4}.footer[_ngcontent-%COMP%]{position:fixed;bottom:0;width:100%;height:100px;background-color:#f5f5f5;z-index:2}\n\n/*# sourceMappingURL=footer.component.css.map*/"]})}const dt={cookie:{domain:w_cookieDomain},position:"bottom",theme:"classic",palette:{popup:{background:"#333",text:"#ffffff",link:"#ffffff"},button:{background:"#f1d600",text:"#333",border:"transparent"}},type:"info",content:{message:"This website requires cookies, and the limited processing of your personal data in order to function. By using the site you are agreeing to this as outlined in our ",dismiss:"Accept cookies",deny:"Refuse cookies",link:"Privacy Notice",href:"https://www.ebi.ac.uk/data-protection/privacy-notice/faang-data-portal",policy:"Cookie Policy"}};class G{constructor(e){this.ccService=e,this.title="faang-portal-frontend-angular-version17"}ngOnInit(){}static#t=this.\u0275fac=function(s){return new(s||G)(t.rXU(rt.e0))};static#e=this.\u0275cmp=t.VBU({type:G,selectors:[["app-root"]],decls:3,vars:0,consts:[["bdColor","rgba(51, 51, 51, 0.8)","size","medium","color","#fff","type","ball-clip-rotate"]],template:function(s,i){1&s&&t.nrm(0,"ngx-spinner",0)(1,"router-outlet")(2,"app-footer")},dependencies:[S.n3,J.et,N],styles:[".container[_ngcontent-%COMP%]{font-family:Arial;margin-bottom:100px}.container-fluid[_ngcontent-%COMP%]{font-family:Arial;margin-bottom:100px;padding:0 5% 1%!important}h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%]{color:#49494a}.navbar[_ngcontent-%COMP%]{padding:0 0 2%!important}button[_ngcontent-%COMP%]:focus{outline:none!important}.igv-container[_ngcontent-%COMP%]{z-index:1}\n\n/*# sourceMappingURL=app.component.css.map*/"]})}var K=f(3777),ot=f(4102),v=f(316),T=f(4175),I=f(3840),D=f(1034),at=f(9552);class O{constructor(e){this.router=e,this.collapsed=!0,this.records_dropdown_open=!1,this.projects_dropdown_open=!1,this.validation_dropdown_open=!1,this.help_dropdown_open=!1,this.show_banner="show"}ngOnInit(){}isActive(e){const s={data:["organism","specimen","dataset","file","analysis","protocol","article"],submit:["ruleset","validation","trackhubs","nextflowSubmission"],help:["api"],search:["graphql","globalsearch"],protocol:["protocol"],validation:["validation"],ruleset:["ruleset"]};for(const i of s[e])if("data"===e){if(this.router.url.includes(i)&&!this.router.url.includes("summary"))return"active"}else if(this.router.url.includes(i))return"active"}static#t=this.\u0275fac=function(s){return new(s||O)(t.rXU(S.Ix))};static#e=this.\u0275cmp=t.VBU({type:O,selectors:[["app-header"]],decls:143,vars:20,consts:[["menu","matMenu"],["data","matMenu"],["submit","matMenu"],["help","matMenu"],["search","matMenu"],[2,"margin-bottom","20px","padding","0 30px"],["fxFlex","","fxLayout",""],[2,"margin-right","15px"],["routerLink","/home"],["alt","FAANG logo","src","../../../assets/FAANG_logo_RGBc.png","height","50","width","auto",1,"d-inline-block","align-top"],["mat-button","","fxHide","false","fxHide.gt-md","",3,"mat-menu-trigger-for"],[2,"font-size","30px"],["fxFlex","","fxLayout","","fxHide.md","","fxHide.lt-md","","fxLayoutAlign","end center"],["mat-button",""],["routerLink","/home","routerLinkActive","active",1,"nav-link"],["mat-button","",3,"matMenuTriggerFor"],[1,"nav-link",3,"ngClass"],[2,"vertical-align","middle"],["routerLink","/projects","routerLinkActive","active",1,"nav-link"],["routerLink","/genome_browser","routerLinkActive","active",1,"nav-link"],["routerLink","/ontology","routerLinkActive","active",1,"nav-link"],["x-position","before"],["mat-menu-item",""],["mat-menu-item","",3,"matMenuTriggerFor"],["routerLink","/summary","routerLinkActive","active",1,"nav-link"],["routerLink","/organism","routerLinkActive","active",1,"nav-link"],["routerLink","/specimen","routerLinkActive","active",1,"nav-link"],[1,"dropdown-divider"],["routerLink","/dataset","routerLinkActive","active",1,"nav-link"],["routerLink","/file","routerLinkActive","active",1,"nav-link"],["routerLink","/analysis","routerLinkActive","active",1,"nav-link"],["routerLink","/protocol/samples",1,"nav-link",3,"ngClass"],["routerLink","/article","routerLinkActive","active",1,"nav-link"],["routerLink","/ruleset/samples","fragment","Standard",1,"nav-link",3,"ngClass"],["routerLink","/validation/samples",1,"nav-link",3,"ngClass"],["routerLink","/trackhubs","routerLinkActive","active",1,"nav-link"],["routerLink","/nextflowSubmission","routerLinkActive","active",1,"nav-link"],["href","https://dcc-documentation.readthedocs.io/en/latest/","target","_blank","routerLinkActive","active",1,"nav-link"],["href","https://dcc-documentation.readthedocs.io/en/latest/faq/","target","_blank",1,"nav-link"],["routerLink","/api","routerLinkActive","active",1,"nav-link"],["routerLink","/graphql","routerLinkActive","active",1,"nav-link"],["routerLink","/globalsearch","routerLinkActive","active",1,"nav-link"]],template:function(s,i){if(1&s&&(t.j41(0,"mat-toolbar",5)(1,"div",6)(2,"div",7)(3,"a",8),t.nrm(4,"img",9),t.k0s()(),t.j41(5,"button",10)(6,"mat-icon",11),t.EFF(7,"menu"),t.k0s()(),t.j41(8,"div",12)(9,"button",13)(10,"a",14),t.EFF(11,"Home"),t.k0s()(),t.j41(12,"button",15)(13,"a",16),t.EFF(14,"Data "),t.j41(15,"mat-icon",17),t.EFF(16,"arrow_drop_down"),t.k0s()()(),t.j41(17,"button",13)(18,"a",18),t.EFF(19,"Projects"),t.k0s()(),t.j41(20,"button",13)(21,"a",19),t.EFF(22," Genome Browser "),t.j41(23,"sup"),t.EFF(24,"Beta"),t.k0s()()(),t.j41(25,"button",15)(26,"a",16),t.EFF(27,"Submit "),t.j41(28,"mat-icon",17),t.EFF(29,"arrow_drop_down"),t.k0s()()(),t.j41(30,"button",13)(31,"a",20),t.EFF(32," Ontology Improver "),t.j41(33,"sup"),t.EFF(34,"Beta"),t.k0s()()(),t.j41(35,"button",15)(36,"a",16),t.EFF(37,"Help "),t.j41(38,"mat-icon",17),t.EFF(39,"arrow_drop_down"),t.k0s()()(),t.j41(40,"button",15)(41,"a",16),t.EFF(42,"Search "),t.j41(43,"mat-icon",17),t.EFF(44,"arrow_drop_down"),t.k0s()()()()()(),t.j41(45,"mat-menu",21,0)(47,"button",22)(48,"a",14),t.EFF(49,"Home"),t.k0s()(),t.j41(50,"button",23)(51,"a",16),t.EFF(52,"Data "),t.k0s()(),t.j41(53,"button",22)(54,"a",18),t.EFF(55,"Projects"),t.k0s()(),t.j41(56,"button",22)(57,"a",24),t.EFF(58,"Summary"),t.k0s()(),t.j41(59,"button",22)(60,"a",19),t.EFF(61," Genome Browser "),t.j41(62,"sup"),t.EFF(63,"Beta"),t.k0s()()(),t.j41(64,"button",23)(65,"a",16),t.EFF(66,"Submit "),t.k0s()(),t.j41(67,"button",22)(68,"a",20),t.EFF(69," Ontology Improver "),t.j41(70,"sup"),t.EFF(71,"Beta"),t.k0s()()(),t.j41(72,"button",23)(73,"a",16),t.EFF(74,"Help "),t.k0s()(),t.j41(75,"button",23)(76,"a",16),t.EFF(77,"Search "),t.k0s()()(),t.j41(78,"mat-menu",null,1)(80,"button",22)(81,"a",25),t.EFF(82,"Organisms"),t.k0s()(),t.j41(83,"button",22)(84,"a",26),t.EFF(85,"Specimens"),t.k0s()(),t.nrm(86,"div",27),t.j41(87,"button",22)(88,"a",28),t.EFF(89,"Datasets"),t.k0s()(),t.j41(90,"button",22)(91,"a",29),t.EFF(92,"Files"),t.k0s()(),t.nrm(93,"div",27),t.j41(94,"button",22)(95,"a",30),t.EFF(96,"Analyses"),t.k0s()(),t.nrm(97,"div",27),t.j41(98,"button",22)(99,"a",31),t.EFF(100,"Protocols"),t.k0s()(),t.j41(101,"button",22)(102,"a",32),t.EFF(103,"Publications"),t.k0s()(),t.j41(104,"button",22)(105,"a",24),t.EFF(106,"Summary"),t.k0s()()(),t.j41(107,"mat-menu",null,2)(109,"button",22)(110,"a",33),t.EFF(111,"Rule sets"),t.k0s()(),t.j41(112,"button",22)(113,"a",34),t.EFF(114,"Validation service"),t.k0s()(),t.j41(115,"button",22)(116,"a",35),t.EFF(117,"Track Hubs "),t.j41(118,"sup"),t.EFF(119,"Beta"),t.k0s()()(),t.j41(120,"button",22)(121,"a",36),t.EFF(122,"NextFlow files"),t.k0s()(),t.nrm(123,"div",27),t.j41(124,"button",22)(125,"a",37),t.EFF(126,"Help"),t.k0s()()(),t.j41(127,"mat-menu",null,3)(129,"button",22)(130,"a",38),t.EFF(131,"FAQ"),t.k0s()(),t.j41(132,"button",22)(133,"a",39),t.EFF(134,"API Documentation"),t.k0s()()(),t.j41(135,"mat-menu",null,4)(137,"button",22)(138,"a",40),t.EFF(139,"Custom queries"),t.k0s()(),t.j41(140,"button",22)(141,"a",41),t.EFF(142,"Search"),t.k0s()()()),2&s){const r=t.sdS(46),n=t.sdS(79),o=t.sdS(108),p=t.sdS(128),u=t.sdS(136);t.R7$(5),t.Y8G("mat-menu-trigger-for",r),t.R7$(7),t.Y8G("matMenuTriggerFor",n),t.R7$(),t.Y8G("ngClass",i.isActive("data")),t.R7$(12),t.Y8G("matMenuTriggerFor",o),t.R7$(),t.Y8G("ngClass",i.isActive("submit")),t.R7$(9),t.Y8G("matMenuTriggerFor",p),t.R7$(),t.Y8G("ngClass",i.isActive("help")),t.R7$(4),t.Y8G("matMenuTriggerFor",u),t.R7$(),t.Y8G("ngClass",i.isActive("search")),t.R7$(9),t.Y8G("matMenuTriggerFor",n),t.R7$(),t.Y8G("ngClass",i.isActive("data")),t.R7$(13),t.Y8G("matMenuTriggerFor",o),t.R7$(),t.Y8G("ngClass",i.isActive("submit")),t.R7$(7),t.Y8G("matMenuTriggerFor",p),t.R7$(),t.Y8G("ngClass",i.isActive("help")),t.R7$(2),t.Y8G("matMenuTriggerFor",u),t.R7$(),t.Y8G("ngClass",i.isActive("search")),t.R7$(23),t.Y8G("ngClass",i.isActive("protocol")),t.R7$(11),t.Y8G("ngClass",i.isActive("ruleset")),t.R7$(3),t.Y8G("ngClass",i.isActive("validation"))}},dependencies:[v.YU,S.Wk,S.wQ,T.$z,I.An,D.kk,D.fb,D.Cp,at.KQ],styles:["a[_ngcontent-%COMP%]{font-family:Arial}.nav-link[_ngcontent-%COMP%]{color:#00000080;font-size:18px}.active[_ngcontent-%COMP%]{color:#000}.mat-button[_ngcontent-%COMP%]{padding:0}\n\n/*# sourceMappingURL=header.component.css.map*/"]})}class M{constructor(e){this.titleService=e}ngOnInit(){this.titleService.setTitle("FAANG data portal")}static#t=this.\u0275fac=function(s){return new(s||M)(t.rXU(P.hE))};static#e=this.\u0275cmp=t.VBU({type:M,selectors:[["app-home"]],decls:88,vars:0,consts:[[1,"container-fluid"],["fxLayout","row","fxLayout.lt-md","column",2,"margin-bottom","5px"],["href","http://www.faang.org"],["src","../../assets/FAANG_WebLogo.png","alt","logo",1,"center-block","faang-logo"],["fxFlex","",2,"padding","1%"],[1,"text-center"],["href","mailto:faang-dcc@ebi.ac.uk?Subject=Data%20portal","target","_top"],["fxLayout","row","fxLayout.lt-md","column","fxLayoutGap","1%"],["fxFlex","58",1,"home-card"],["routerLink","/organism"],["routerLink","/specimen"],["routerLink","/dataset"],["routerLink","/file"],["routerLink","/graphql"],["fxFlex","42","fxLayout","column","fxLayoutGap","2%"],["fxFlex","",1,"home-card"],["href","http://www.faang.org/cgi-bin/host/misc/FAANG/mem","target","_blank"],["href","https://dcc-documentation.readthedocs.io/en/latest/"],["href","https://www.faang.org/data-share-principle","target","_blank"]],template:function(s,i){1&s&&(t.nrm(0,"app-header"),t.j41(1,"div",0)(2,"div",1)(3,"a",2),t.nrm(4,"img",3),t.k0s(),t.j41(5,"div",4)(6,"h1",5),t.EFF(7,"Data Portal"),t.k0s(),t.j41(8,"div")(9,"p")(10,"a",2),t.EFF(11,"FAANG"),t.k0s(),t.EFF(12," is the "),t.j41(13,"strong"),t.EFF(14,"F"),t.k0s(),t.EFF(15,"unctional "),t.j41(16,"strong"),t.EFF(17,"A"),t.k0s(),t.EFF(18,"nnotation of "),t.j41(19,"strong"),t.EFF(20,"AN"),t.k0s(),t.EFF(21,"imal "),t.j41(22,"strong"),t.EFF(23,"G"),t.k0s(),t.EFF(24,"enomes project. We are working to understand the genotype to phenotype link in domesticated animals. "),t.k0s(),t.j41(25,"p"),t.EFF(26," This data portal will help find and browse FAANG's data. Let us know what you think at "),t.j41(27,"a",6),t.EFF(28,"faang-dcc@ebi.ac.uk"),t.k0s(),t.EFF(29,". "),t.k0s()()()(),t.j41(30,"div",7)(31,"mat-card",8)(32,"h5"),t.EFF(33,"Using this site"),t.k0s(),t.nrm(34,"mat-divider"),t.j41(35,"div")(36,"p"),t.EFF(37," The "),t.j41(38,"a",9),t.EFF(39,"Organisms"),t.k0s(),t.EFF(40,' page lets you search for any organism in the FAANG data set. We use the term "organism" to mean any individual animal that has contributed a biological specimen. Click an item in the list to see full details of the organism. '),t.k0s(),t.j41(41,"p"),t.EFF(42," The "),t.j41(43,"a",10),t.EFF(44,"Specimens"),t.k0s(),t.EFF(45,' page lets you search for any specimen in the FAANG data set. We use the term "specimen" to mean any biological material originating from a particular organism. Click an item in the list to see full details of the specimen. '),t.k0s(),t.j41(46,"p"),t.EFF(47," The "),t.j41(48,"a",11),t.EFF(49,"Dataset"),t.k0s(),t.EFF(50,' page lets you search for any dataset in the FAANG data set. We use the term "dataset" to mean the Study concept used in ENA (also referred as a Project). Click an item in the list to see full details of the dataset. '),t.k0s(),t.j41(51,"p"),t.EFF(52," The "),t.j41(53,"a",12),t.EFF(54,"File"),t.k0s(),t.EFF(55,' page lets you search for any experiment files in the FAANG data set. We use the term "file" to mean any experiment assay file that has been submitted to a public archive. Click an item in the list to see full details of the file. '),t.k0s(),t.j41(56,"p"),t.EFF(57," The "),t.j41(58,"a",13),t.EFF(59,"Search"),t.k0s(),t.EFF(60," page lets you search across different types of data tables. It enables custom search allowing you to join tables and select specific columns. Click an item in the results list to see full details. "),t.k0s()()(),t.j41(61,"div",14)(62,"mat-card",15)(63,"h5"),t.EFF(64,"Contribute to FAANG"),t.k0s(),t.nrm(65,"mat-divider"),t.j41(66,"div")(67,"p")(68,"a",16),t.EFF(69,"Sign up to become part of the FAANG community"),t.k0s(),t.EFF(70," and join the working commitees."),t.k0s(),t.j41(71,"p"),t.EFF(72,"Instructions on how to submit your samples and analyses to FAANG are detailed on the "),t.j41(73,"a",17),t.EFF(74,"FAANG submission guidelines"),t.k0s(),t.EFF(75,"."),t.k0s()()(),t.j41(76,"mat-card",15)(77,"h5"),t.EFF(78,"It's good to share"),t.k0s(),t.nrm(79,"mat-divider"),t.j41(80,"div")(81,"p"),t.EFF(82,"FAANG is committed to sharing data rapidly, before publication. All members have agreed to the "),t.j41(83,"a",18),t.EFF(84,"FAANG Data Sharing Statement"),t.k0s(),t.EFF(85," for pre-publication data release."),t.k0s(),t.j41(86,"p"),t.EFF(87,"FAANG is also committed to making regular public releases of primary and secondary analysis results to provide access to the wider community."),t.k0s()()()()()())},dependencies:[S.Wk,K.RN,ot.q,O],styles:["img.faang-logo[_ngcontent-%COMP%]{max-width:70%}@media (max-width: 767px){img.faang-logo[_ngcontent-%COMP%]{width:300px}}.home-card[_ngcontent-%COMP%]{border:solid .2px rgba(0,0,0,.15);padding:16px}p[_ngcontent-%COMP%]{font-size:14px;font-family:Arial}a[_ngcontent-%COMP%]{color:#4682b4}hr[_ngcontent-%COMP%]{width:100%;background-color:#ccc}mat-card[_ngcontent-%COMP%]{font-family:Roboto,Helvetica Neue,sans-serif}mat-divider[_ngcontent-%COMP%]{margin-top:10px;margin-bottom:15px}\n\n/*# sourceMappingURL=home.component.css.map*/"]})}var Q=f(4624),z=f(2047),F=f(906),ft=f(3617),_t=f(9452),bt=f(3037),vt=f(6647),d=f(271),g=f(1318),St=f(9475);const nt=["male","male genotypic sex","intact male","M","Male"],ct=["female","female genotypic sex","intact female","F","Female"],lt=["AGR","CBA","CTX","MED","PMC"],Z="https://raw.githubusercontent.com/FAANG/dcc-metadata/master/json_schema/",$="https://api.faang.org";var b=f(4456),y=f(7941);class yt{constructor(){this.host=w_host,this.relatedProjectsHost=w_relatedProjectsHost}getHost(){return this.host}setHost(e){this.host=e}}var _=f(6443),xt=f(9400),pt=f(7919),m=f(1995);function ut(a){if(a)return-1!==a.indexOf("_")?a.split("_").join(" "):a}const U={experimentalProtocol:"Experimental protocol",extractionProtocol:"Extraction protocol",rnaPreparation3AdapterLigationProtocol:"Rna preparation 3' adapter ligation protocol",rnaPreparation5AdapterLigationProtocol:"Rna preparation 5' adapter ligation protocol",libraryGenerationPcrProductIsolationProtocol:"Library generation PCR product isolation protocol",preparationReverseTranscriptionProtocol:"Preparation reverse transcription protocol",libraryGenerationProtocol:"Library generation protocol",bisulfiteConversionProtocol:"Bisulfite conversion protocol",pcrProductIsolationProtocol:"PCR product isolation protocol",transposaseProtocol:"Transposase protocol",dnaseProtocol:"DNase protocol",chipProtocol:"ChIP protocol","hi-cProtocol":"Hi-C protocol",cageProtocol:"CAGE protocol"},jt={"Experimental protocol":"experimentalProtocol","Extraction protocol":"extractionProtocol","Rna preparation 3' adapter ligation protocol":"rnaPreparation3AdapterLigationProtocol","Rna preparation 5' adapter ligation protocol":"rnaPreparation5AdapterLigationProtocol","Library generation PCR product isolation protocol":"libraryGenerationPcrProductIsolationProtocol","Preparation reverse transcription protocol":"preparationReverseTranscriptionProtocol","Library generation protocol":"libraryGenerationProtocol","Bisulfite conversion protocol":"bisulfiteConversionProtocol","PCR product isolation protocol":"pcrProductIsolationProtocol","Transposase protocol":"transposaseProtocol","DNase protocol":"dnaseProtocol","ChIP protocol":"chipProtocol","Hi-C protocol":"hi-cProtocol"};var q=f(4205);class A{constructor(e){this.http=e,this.loginSuccess=new q.B,this.errors=[],this.httpOptions={headers:new _.Lr({"Content-Type":"application/json"})}}login(e){this.http.post("https://api.faang.org/api-token-auth/",JSON.stringify(e),this.httpOptions).subscribe(s=>{console.log("login success",s),this.loginSuccess.next(!0),this.updateData(s.token)},s=>{console.error("login error",s),this.errors=s.error})}refreshToken(){this.http.post("https://api.faang.org/api-token-refresh/",JSON.stringify({token:this.token}),this.httpOptions).subscribe(e=>{console.log("refresh success",e),this.updateData(e.token)},e=>{console.error("refresh error",e),this.errors=e.error})}testToken(){this.http.get("https://api.faang.org/private_portal/organism/",{headers:new _.Lr({Authorization:`jwt ${this.token}`})}).subscribe(e=>{console.log(e)})}logout(){this.token=null,this.token_expires=null,this.username=null}updateData(e){this.token=e,this.errors=[];const s=this.token.split(/\./),i=JSON.parse(window.atob(s[1]));this.token_expires=new Date(1e3*i.exp),this.username=i.username}static#t=this.\u0275fac=function(s){return new(s||A)(t.KVO(_.Qq))};static#e=this.\u0275prov=t.jDH({token:A,factory:A.\u0275fac,providedIn:"root"})}class E{constructor(){}set_current_api_filters(e){this.current_api_filters=e}get_current_api_filters(){return this.current_api_filters}static#t=this.\u0275fac=function(s){return new(s||E)};static#e=this.\u0275prov=t.jDH({token:E,factory:E.\u0275fac,providedIn:"root"})}class k{constructor(e,s,i){this.http=e,this._userService=s,this.apiFiltersService=i,this.hostSetting=new yt}getGSearchData(e){const s=`${this.hostSetting.host}data/_gsearch/?sterm=${e}`,i={};return this.http.get(s).pipe((0,d.T)(r=>{for(const[n,o]of Object.entries(r))i[n]={totalHits:o.hits.total.value,searchTerms:o.search_terms||[]};return i}),(0,m.L)(3),(0,g.W)(this.handleError))}getAllFiles(e,s){const i=`${this.hostSetting.host}data/file/_search/?size=${s}`,r={species:"species.text",assay_type:"experiment.assayType",target:"experiment.target",instrument:"run.instrument",assayType:"experiment.assayType",standard:"experiment.standardMet",paper_published:"paperPublished",project:"secondaryProject"},n={fileName:"name",study:"study.accession",experiment:"experiment.accession",species:"species.text",assay_type:"experiment.assayType",target:"experiment.target",specimen:"specimen",instrument:"run.instrument",assayType:"experiment.assayType",standard:"experiment.standardMet",paper_published:"paperPublished"},o=e.filters;for(const c of Object.keys(o))r[c]&&c!==r[c]&&(o[r[c]]=o[c],delete o[c]);this.apiFiltersService.set_current_api_filters(o);const p=n[e.sort[0]]?n[e.sort[0]]+":"+e.sort[1]:e.sort[0]+":"+e.sort[1],u=(new _.Nl).set("_source",e._source.toString()).set("sort",p).set("filters",JSON.stringify(o)).set("aggs",JSON.stringify(r)).set("from_",e.from_).set("search",e.search),l={};return this.http.get(i,{params:u}).pipe((0,d.T)(c=>(l.data=c.hits.hits.map(h=>({fileName:h._id,study:h._source.study.accession,experiment:h._source.experiment.accession,species:h._source.species.text,assayType:h._source.experiment.assayType,target:h._source.experiment.target,specimen:h._source.specimen,instrument:h._source.run.instrument,standard:h._source.experiment.standardMet,paperPublished:h._source.paperPublished,submitterEmail:h._source.submitterEmail})),l.totalHits=c.hits.total.value,l.aggregations=c.aggregations,l)),(0,m.L)(3),(0,g.W)(this.handleError))}getEnsemblAnnotationData(e,s,i){const r={},n=JSON.stringify({"project.keyword":e}),o=`${this.hostSetting.host}data/ensembl_annotation/_search/?size=10&filters=${n}&sort=${s}&from_=${i}`;return this.http.get(o).pipe((0,d.T)(p=>(r.data=p.hits.hits.map(u=>u._source),r.totalHits=p.hits.total.value,r)),(0,m.L)(3),(0,g.W)(this.handleError))}getTrackhubsData(){const e={},s=`${this.hostSetting.host}data/trackhubs/_search/?size=10`;return this.http.get(s).pipe((0,d.T)(i=>(e.data=i.hits.hits.map(r=>r._source),e.totalHits=i.hits.total.value,e)),(0,m.L)(3),(0,g.W)(this.handleError))}downloadRecords(e,s,i){const r=`${this.hostSetting.host}data/${e}/download/`,n=i.filters;for(const l of Object.keys(n))s[l]&&l!==s[l]&&(n[s[l]]=n[l],delete n[l]);const o=s[i.sort[0]]?s[i.sort[0]]+":"+i.sort[1]:i.sort[0]+":"+i.sort[1],u=`${r}?${(new _.Nl).set("_source",i._source.toString()).set("sort",o).set("filters",JSON.stringify(n)).set("columns",JSON.stringify(i.columns)).set("file_format",i.file_format).toString()}`;return this.http.get(u,{responseType:"blob"}).pipe((0,d.T)(l=>l),(0,g.W)(this.handleError))}downloadGraphqlRecords(e,s,i,r){const p=`${`${this.hostSetting.host}graphql/download`}?${(new _.Nl).set("selected_indices",JSON.stringify(e)).set("selected_columns",JSON.stringify(s)).set("query",JSON.stringify(i)).set("query_name",JSON.stringify(r)).toString()}`;return this.http.get(p,{responseType:"blob"}).pipe((0,d.T)(u=>u),(0,g.W)(this.handleError))}getAllFilesForProject(e,s,i,r,n){const o={};if("private"===s){const p=`${this.hostSetting.host}private_portal/file/?size=10&from_=${r}&search=${n}`;return this.http.get(p,{headers:new _.Lr({Authorization:`jwt ${this._userService.token}`})}).pipe((0,d.T)(u=>(o.data=u.hits.hits.map(l=>({name:l._source.name,fileId:l._id,experiment:l._source.experiment.accession,assayType:l._source.experiment.assayType,experimentTarget:l._source.experiment.target,run:l._source.run.accession,readableSize:l._source.readableSize,checksum:l._source.checksum,checksumMethod:l._source.checksumMethod,url:l._source.url,secondaryProject:l._source.secondaryProject.toString(),private:l._source.private})),o.totalHits=u.hits.total.value,o)),(0,m.L)(3),(0,g.W)(this.handleError))}{const p=JSON.stringify({secondaryProject:e}),u=`${this.hostSetting.host}data/file/_search/?size=10&filters=${p}&sort=${i}&from_=${r}&search=${n}`;return this.http.get(u).pipe((0,d.T)(l=>(o.data=l.hits.hits.map(c=>({name:c._source.name,fileId:c._id,experiment:c._source.experiment.accession,assayType:c._source.experiment.assayType,experimentTarget:c._source.experiment.target,run:c._source.run.accession,readableSize:c._source.readableSize,checksum:c._source.checksum,checksumMethod:c._source.checksumMethod,url:c._source.url,secondaryProject:c._source.secondaryProject.toString(),private:!1})),o.totalHits=l.hits.total.value,o)),(0,m.L)(3),(0,g.W)(this.handleError))}}getAllDatasetsForProject(e,s,i,r,n){const o={};if("private"===s){const p=`${this.hostSetting.host}private_portal/dataset/?size=10&from_=${r}&search=${n}`;return this.http.get(p,{headers:new _.Lr({Authorization:`jwt ${this._userService.token}`})}).pipe((0,d.T)(u=>(o.data=u.hits.hits.map(l=>({datasetAccession:l._source.accession,title:l._source.title,species:l._source.species[0].text,archive:l._source.archive[0],assayType:l._source.assayType[0],numberOfExperiments:l._source.experiment.length,numberOfSpecimens:l._source.specimen.length,numberOfFiles:l._source.file.length,standard:l._source.standardMet,private:l._source.private})),o.totalHits=u.hits.total.value,o)),(0,m.L)(3),(0,g.W)(this.handleError))}{const p=JSON.stringify({secondaryProject:e});let u=`${this.hostSetting.host}data/dataset/_search/?size=10&filters=${p}&from_=${r}&search=${n}`;const l=i.split(":")[0];return u="experiment"===l||"specimen"===l||"file"===l?u+"&sort_by_count="+i:u+"&sort="+i,this.http.get(u).pipe((0,d.T)(c=>(o.data=c.hits.hits.map(h=>({datasetAccession:h._source.accession,title:h._source.title,species:h._source.species[0].text,archive:h._source.archive[0],assayType:h._source.assayType[0],numberOfExperiments:h._source.experiment.length,numberOfSpecimens:h._source.specimen.length,numberOfFiles:h._source.file.length,standard:h._source.standardMet,secondaryProject:h._source.secondaryProject.toString(),private:!1})),o.totalHits=c.hits.total.value,o)),(0,m.L)(3),(0,g.W)(this.handleError))}}getFile(e,s){let i=`${this.hostSetting.host}data/file/${e}`;return"private"===s?(i="https://api.faang.org/private_portal/file/"+e,this.http.get(i,{headers:new _.Lr({Authorization:`jwt ${this._userService.token}`})}).pipe((0,m.L)(3),(0,g.W)(this.handleError))):this.http.get(i).pipe((0,m.L)(3),(0,g.W)(this.handleError))}getFilesByRun(e,s,i,r,n){const o=JSON.stringify({"run.accession":[e]});let p=`${this.hostSetting.host}data/file/_search/?filters=${o}&size=10&sort=${s}&from_=${i}&search=${r}`;if("private"===n)return p=`https://api.faang.org/private_portal/file/${e}`,this.http.get(p,{headers:new _.Lr({Authorization:`jwt ${this._userService.token}`})}).pipe((0,m.L)(3),(0,g.W)(this.handleError));const u={};return this.http.get(p).pipe((0,d.T)(l=>(u.data=l.hits.hits,u.totalHits=l.hits.total.value,u)),(0,m.L)(3),(0,g.W)(this.handleError))}getExperimentByAccession(e){const s=`${this.hostSetting.host}data/experiment/${e}`;return this.http.get(s).pipe((0,m.L)(3),(0,g.W)(this.handleError))}getAllOntologiesWorkshop(e,s){const i=`${this.hostSetting.host}data/ontologies_test/_search/?size=${s}`,r={projects:"projects",type:"type"},n=e.filters;for(const l of Object.keys(n))r[l]&&l!==r[l]&&(n[r[l]]=n[l],delete n[l]);const o=e.sort[0]+":"+e.sort[1],p=(new _.Nl).set("_source",e._source.toString()).set("sort",o).set("filters",JSON.stringify(n)).set("aggs",JSON.stringify(r)).set("from_",e.from_).set("search",e.search),u={};return this.http.get(i,{params:p}).pipe((0,d.T)(l=>(u.data=l.hits.hits.map(c=>c._source),u.totalHits=l.hits.total.value,u.aggregations=l.aggregations,u)),(0,m.L)(3),(0,g.W)(this.handleError))}getAllOntologies(e,s){const i=`${this.hostSetting.host}data/ontologies/_search/?size=${s}`,r={projects:"projects",type:"type",status_activity:"status_activity"},n=e.filters;for(const l of Object.keys(n))r[l]&&l!==r[l]&&(n[r[l]]=n[l],delete n[l]);const o=e.sort[0]+":"+e.sort[1],p=(new _.Nl).set("_source",e._source.toString()).set("sort",o).set("filters",JSON.stringify(n)).set("aggs",JSON.stringify(r)).set("from_",e.from_).set("search",e.search),u={};return this.http.get(i,{params:p}).pipe((0,d.T)(l=>(u.data=l.hits.hits.map(c=>c._source),u.totalHits=l.hits.total.value,u.aggregations=l.aggregations,"status_activity"in u.aggregations&&(u.aggregations.status_activity=u.aggregations.status_activity.status,u.aggregations.status_activity.buckets=u.aggregations.status_activity.buckets.filter(c=>"Awaiting Assessment"!==c.key)),u)),(0,m.L)(3),(0,g.W)(this.handleError))}getOntologyById(e,s){const i=`${this.hostSetting.host}data/${s}/${e}`;return this.http.get(i).pipe((0,d.T)(r=>r.hits.hits[0]._source),(0,m.L)(3),(0,g.W)(this.handleError))}getAllOrganisms(e,s){const i=`${this.hostSetting.host}data/organism/_search/?size=${s}`,r={sex:"sex.text",organism:"organism.text",breed:"breed.text",standard:"standardMet",paper_published:"paperPublished",project:"secondaryProject"},n={bioSampleId:"biosampleId",sex:"sex.text",organism:"organism.text",breed:"breed.text",standard:"standardMet",idNumber:"id_number",paper_published:"paperPublished"},o=e.filters;for(const c of Object.keys(o))r[c]&&c!==r[c]&&(o[r[c]]=o[c],delete o[c]);this.apiFiltersService.set_current_api_filters(o);const p=n[e.sort[0]]?n[e.sort[0]]+":"+e.sort[1]:e.sort[0]+":"+e.sort[1],u=(new _.Nl).set("_source",e._source.toString()).set("sort",p).set("filters",JSON.stringify(o)).set("aggs",JSON.stringify(r)).set("from_",e.from_).set("search",e.search),l={};return this.http.get(i,{params:u}).pipe((0,d.T)(c=>(l.data=c.hits.hits.map(h=>({bioSampleId:h._source.biosampleId,sex:h._source.sex.text,organism:h._source.organism.text,breed:h._source.breed.text,standard:h._source.standardMet,idNumber:h._source.id_number,paperPublished:h._source.paperPublished})),l.totalHits=c.hits.total.value,l.aggregations=c.aggregations,l)),(0,m.L)(3),(0,g.W)(this.handleError))}getAllOrganismsFromProject(e,s,i,r,n){const o={};if("private"===s){const p=`${this.hostSetting.host}private_portal/organism/?size=10&from_=${r}&search=${n}`;return this.http.get(p,{headers:new _.Lr({Authorization:`jwt ${this._userService.token}`})}).pipe((0,d.T)(u=>(o.data=u.hits.hits.map(l=>({bioSampleId:l._source.biosampleId,sex:l._source.sex.text,organism:l._source.organism.text,breed:l._source.breed.text,private:this.checkPrivateData(l._source.customField)})),o.totalHits=u.hits.total.value,o)),(0,g.W)(this.handleError))}{const p=JSON.stringify({secondaryProject:e}),u=`${this.hostSetting.host}data/organism/_search/?size=10&filters=${p}&sort=${i}&from_=${r}&search=${n}`;return this.http.get(u).pipe((0,d.T)(l=>(o.data=l.hits.hits.map(c=>({bioSampleId:c._source.biosampleId,sex:c._source.sex.text,organism:c._source.organism.text,breed:c._source.breed.text,secondaryProject:c._source.secondaryProject.toString(),private:this.checkPrivateData(c._source.customField)})),o.totalHits=l.hits.total.value,o)),(0,m.L)(3),(0,g.W)(this.handleError))}}checkPrivateData(e){for(const s of e)if("BovReg private submission"===s.name)return!0}getOrganism(e,s){let i=`${this.hostSetting.host}data/organism/${e}`;return"private"===s?(i=`https://api.faang.org/private_portal/organism/${e}/`,this.http.get(i,{headers:new _.Lr({Authorization:`jwt ${this._userService.token}`})}).pipe((0,m.L)(3),(0,g.W)(this.handleError))):this.http.get(i).pipe((0,m.L)(3),(0,g.W)(this.handleError))}getOrganismsSpecimens(e,s,i,r,n){if("private"===r){const o=`${this.hostSetting.host}private_portal/specimen/?q=organism.biosampleId:${e}&size=10&from_=${i}&search=${n}`;return this.http.get(o,{headers:new _.Lr({Authorization:`jwt ${this._userService.token}`})}).pipe((0,m.L)(3),(0,g.W)(this.handleError))}{const o=JSON.stringify({"organism.biosampleId":[e]}),p=`${this.hostSetting.host}data/specimen/_search/?filters=${o}&sort=${s}&size=10&from_=${i}&search=${n}`;return this.http.get(p).pipe((0,m.L)(3),(0,g.W)(this.handleError))}}getAllSpecimensForProject(e,s,i,r,n){const o={};if("private"===s){const p=`${this.hostSetting.host}private_portal/specimen/?size=10&from_=${r}&search=${n}`;return this.http.get(p,{headers:new _.Lr({Authorization:`jwt ${this._userService.token}`})}).pipe((0,d.T)(u=>(o.data=u.hits.hits.map(l=>({bioSampleId:l._source.biosampleId,material:this.checkField(l._source.material),organismpart_celltype:this.checkField(l._source.cellType),sex:this.checkField(l._source.organism.sex),organism:this.checkField(l._source.organism.organism),breed:this.checkField(l._source.organism.breed),private:this.checkPrivateData(l._source.customField)})),o.totalHits=u.hits.total.value,o)),(0,g.W)(this.handleError))}{const p=JSON.stringify({secondaryProject:e}),u=`${this.hostSetting.host}data/specimen/_search/?size=10&filters=${p}&sort=${i}&from_=${r}&search=${n}`;return this.http.get(u).pipe((0,d.T)(l=>(o.data=l.hits.hits.map(c=>({bioSampleId:c._source.biosampleId,material:this.checkField(c._source.material),organismpart_celltype:this.checkField(c._source.cellType),sex:this.checkField(c._source.organism.sex),organism:this.checkField(c._source.organism.organism),breed:this.checkField(c._source.organism.breed),secondaryProject:c._source.secondaryProject.toString(),private:this.checkPrivateData(c._source.customField)})),o.totalHits=l.hits.total.value,o)),(0,m.L)(3),(0,g.W)(this.handleError))}}getAllProtocolSamplesForProject(e,s,i,r,n){const o={},p=JSON.stringify({secondaryProject:e}),u=`${this.hostSetting.host}data/protocol_samples/_search/?size=10&filters=${p}&sort=${i}&from_=${r}&search=${n}`;return this.http.get(u).pipe((0,d.T)(l=>(o.data=l.hits.hits.map(c=>({key:c._source.key,protocol_name:c._source.protocolName,university_name:c._source.universityName,protocol_date:c._source.protocolDate,secondaryProject:c._source.secondaryProject.toString()})),o.totalHits=l.hits.total.value,o)),(0,m.L)(3),(0,g.W)(this.handleError))}getAllProtocolFilesForProject(e,s,i,r,n){const o={},p=JSON.stringify({secondaryProject:e}),u=`${this.hostSetting.host}data/protocol_files/_search/?size=10&filters=${p}&sort=${i}&from_=${r}&search=${n}`;return this.http.get(u).pipe((0,d.T)(l=>(o.data=l.hits.hits.map(c=>({key:c._source.key,protocol_type:U[c._source.name],experiment_target:c._source.experimentTarget,assay_type:c._source.assayType,secondaryProject:c._source.secondaryProject.toString()})),o.totalHits=l.hits.total.value,o)),(0,m.L)(3),(0,g.W)(this.handleError))}getAllProtocolAnalysisForProject(e,s,i,r,n){const o={},p=JSON.stringify({secondaryProject:e}),u=`${this.hostSetting.host}data/protocol_analysis/_search/?size=10&filters=${p}&sort=${i}&from_=${r}&search=${n}`;return this.http.get(u).pipe((0,d.T)(l=>(o.data=l.hits.hits.map(c=>({key:c._source.key,protocol_name:c._source.protocolName,university_name:c._source.universityName,protocol_date:c._source.protocolDate,secondaryProject:c._source.secondaryProject.toString()})),o.totalHits=l.hits.total.value,o)),(0,m.L)(3),(0,g.W)(this.handleError))}getAllSpecimens(e,s){const i=`${this.hostSetting.host}data/specimen/_search/?size=${s}`,r={standard:"standardMet",sex:"organism.sex.text",organism:"organism.organism.text",material:"material.text",organismpart_celltype:"cellType.text",breed:"organism.breed.text",paper_published:"paperPublished",project:"secondaryProject"},n={bioSampleId:"biosampleId",standard:"standardMet",id_number:"id_number",sex:"organism.sex.text",organism:"organism.organism.text",material:"material.text",organismpart_celltype:"cellType.text",breed:"organism.breed.text",paper_published:"paperPublished",trackhubUrl:"trackhubUrl"},o=e.filters;for(const c of Object.keys(o))r[c]&&c!==r[c]&&(o[r[c]]=o[c],delete o[c]);this.apiFiltersService.set_current_api_filters(o);const p=n[e.sort[0]]?n[e.sort[0]]+":"+e.sort[1]:e.sort[0]+":"+e.sort[1],u=(new _.Nl).set("_source",e._source.toString()).set("sort",p).set("filters",JSON.stringify(o)).set("aggs",JSON.stringify(r)).set("from_",e.from_).set("search",e.search),l={};return this.http.get(i,{params:u}).pipe((0,d.T)(c=>(l.data=c.hits.hits.map(h=>({bioSampleId:h._source.biosampleId,material:this.checkField(h._source.material),organismpart_celltype:this.checkField(h._source.cellType),sex:this.checkField(h._source.organism.sex),organism:this.checkField(h._source.organism.organism),breed:this.checkField(h._source.organism.breed),standard:h._source.standardMet,idNumber:h._source.id_number,paperPublished:h._source.paperPublished,trackhubUrl:h._source.trackhubUrl})),l.totalHits=c.hits.total.value,l.aggregations=c.aggregations,l)),(0,m.L)(3),(0,g.W)(this.handleError))}checkField(e){return e&&typeof e<"u"?e.text:""}getSpecimen(e,s){let i=`${this.hostSetting.host}data/specimen/${e}`;return"private"===s?(i=`https://api.faang.org/private_portal/specimen/${e}`,this.http.get(i,{headers:new _.Lr({Authorization:`jwt ${this._userService.token}`})}).pipe((0,m.L)(3),(0,g.W)(this.handleError))):this.http.get(i).pipe((0,m.L)(3),(0,g.W)(this.handleError))}getSpecimenFiles(e,s,i,r){const n=JSON.stringify({specimen:[e]}),o=`${this.hostSetting.host}data/file/_search/?filters=${n}&size=10&sort=${s}&from_=${i}&search=${r}`,p={};return this.http.get(o).pipe((0,d.T)(u=>(p.data=u.hits.hits,p.totalHits=u.hits.total.value,p)),(0,m.L)(3),(0,g.W)(this.handleError))}getSpecimenRelationships(e,s,i,r){const n=JSON.stringify({allDeriveFromSpecimens:[e]}),o=`${this.hostSetting.host}data/specimen/_search/?filters=${n}&size=10&sort=${s}&from_=${i}&search=${r}`,p={};return this.http.get(o).pipe((0,d.T)(u=>(p.data=u.hits.hits,p.totalHits=u.hits.total.value,p)),(0,m.L)(3),(0,g.W)(this.handleError))}getAllDatasets(e,s){const i=`${this.hostSetting.host}data/dataset/_search/?size=${s}`,r={archive:"archive",species:"species.text",assay_type:"assayType",standard:"standardMet",paper_published:"paperPublished",project:"secondaryProject"},n={datasetAccession:"accession",title:"title",species:"species.text",archive:"archive",assayType:"assayType",numberOfExperiments:"experiment",numberOfSpecimens:"specimen",numberOfFiles:"file",standard:"standardMet",paper_published:"paperPublished"},o=e.filters;for(const c of Object.keys(o))r[c]&&c!==r[c]&&(o[r[c]]=o[c],delete o[c]);this.apiFiltersService.set_current_api_filters(o);const p=n[e.sort[0]]?n[e.sort[0]]+":"+e.sort[1]:e.sort[0]+":"+e.sort[1];let u=(new _.Nl).set("_source",e._source.toString()).set("filters",JSON.stringify(o)).set("aggs",JSON.stringify(r)).set("from_",e.from_).set("search",e.search);u="numberOfExperiments"===e.sort[0]||"numberOfSpecimens"===e.sort[0]||"numberOfFiles"===e.sort[0]?u.set("sort_by_count",p):u.set("sort",p);const l={};return this.http.get(i,{params:u}).pipe((0,d.T)(c=>(l.data=c.hits.hits.map(h=>({datasetAccession:h._source.accession,title:h._source.title,species:this.getSpeciesStr(h),archive:h._source.archive.toString(),assayType:h._source.assayType.toString(),numberOfExperiments:h._source.experiment.length,numberOfSpecimens:h._source.specimen.length,numberOfFiles:h._source.file.length,standard:h._source.standardMet,paperPublished:h._source.paperPublished,submitterEmail:h._source.submitterEmail})),l.totalHits=c.hits.total.value,l.aggregations=c.aggregations,l)),(0,m.L)(3),(0,g.W)(this.handleError))}getSpeciesStr(e){const s=e._source.species;let i="";for(let r=s.length-1;r>=0;r--)i+=s[r].text+",";return i.substring(0,i.length-1)}getDataset(e,s){let i=`${this.hostSetting.host}data/dataset/${e}`;return"private"===s?(i=`https://api.faang.org/private_portal/dataset/${e}`,this.http.get(i,{headers:new _.Lr({Authorization:`jwt ${this._userService.token}`})}).pipe((0,m.L)(3),(0,g.W)(this.handleError))):this.http.get(i).pipe((0,m.L)(3),(0,g.W)(this.handleError))}getAllAnalyses(e,s){const i=`${this.hostSetting.host}data/analysis/_search/?size=${s}`,r={dataset:"datasetAccession",species:"organism.text",assay_type:"assayType",analysis_type:"analysisType",standard:"standardMet",project:"secondaryProject"},n={accession:"accession",datasetAccession:"datasetAccession",title:"title",species:"organism.text",assayType:"assayType",analysisType:"analysisType",standard:"standardMet"},o=e.filters;for(const c of Object.keys(o))r[c]&&c!==r[c]&&(o[r[c]]=o[c],delete o[c]);this.apiFiltersService.set_current_api_filters(o);const p=n[e.sort[0]]?n[e.sort[0]]+":"+e.sort[1]:e.sort[0]+":"+e.sort[1],u=(new _.Nl).set("_source",e._source.toString()).set("sort",p).set("filters",JSON.stringify(o)).set("aggs",JSON.stringify(r)).set("from_",e.from_).set("search",e.search),l={};return this.http.get(i,{params:u}).pipe((0,d.T)(c=>(l.data=c.hits.hits.map(h=>({accession:h._source.accession,datasetAccession:h._source.datasetAccession,title:h._source.title,species:h._source.organism.text,assayType:h._source.assayType,analysisType:ut(h._source.analysisType),standard:h._source.standardMet})),l.totalHits=c.hits.total.value,l.aggregations=c.aggregations,l)),(0,m.L)(3),(0,g.W)(this.handleError))}getAnalysesBySample(e,s,i,r){const n=JSON.stringify({sampleAccessions:[e]}),o=`${this.hostSetting.host}data/analysis/_search/?filters=${n}&size=10&sort=${s}&from_=${i}&search=${r}`,p={};return this.http.get(o).pipe((0,d.T)(u=>(p.data=u.hits.hits,p.totalHits=u.hits.total.value,p)),(0,m.L)(3),(0,g.W)(this.handleError))}getAnalysesByDataset(e,s,i,r,n){const o={};if("private"===r){const p=`${this.hostSetting.host}private_portal/analysis/?q=datasetAccession:${e}&size=10&from_=${i}&search=${n}`;return this.http.get(p,{headers:new _.Lr({Authorization:`jwt ${this._userService.token}`})}).pipe((0,d.T)(u=>(o.data=u.hits.hits,o.totalHits=u.hits.total.value,o)),(0,m.L)(3),(0,g.W)(this.handleError))}{const p=JSON.stringify({datasetAccession:[e]}),u=`${this.hostSetting.host}data/analysis/_search/?filters=${p}&size=10&sort=${s}&from_=${i}&search=${n}`;return this.http.get(u).pipe((0,d.T)(l=>(o.data=l.hits.hits,o.totalHits=l.hits.total.value,o)),(0,m.L)(3),(0,g.W)(this.handleError))}}getAnalysis(e,s){let i=`${this.hostSetting.host}data/analysis/${e}`;return"private"===s?(i=`https://api.faang.org/private_portal/analysis/${e}`,this.http.get(i,{headers:new _.Lr({Authorization:`jwt ${this._userService.token}`})}).pipe((0,m.L)(3),(0,g.W)(this.handleError))):this.http.get(i).pipe((0,m.L)(3),(0,g.W)(this.handleError))}getAllArticlesForProject(e,s,i,r){const n=JSON.stringify({secondaryProject:e}),o=`${this.hostSetting.host}data/article/_search/?size=10&filters=${n}&sort=${s}&from_=${i}&search=${r}`,p={};return this.http.get(o).pipe((0,d.T)(u=>(p.data=u.hits.hits.map(l=>({id:l._id,title:l._source.title,year:l._source.year,journal:l._source.journal,datasetSource:l._source.datasetSource,secondaryProject:l._source.secondaryProject.toString()})),p.totalHits=u.hits.total.value,p)),(0,m.L)(3),(0,g.W)(this.handleError))}getAllPipelinesForProject(e){const s=this.hostSetting.relatedProjectsHost+e.toLowerCase()+"/pipelines.tsv";let i=[];return this.http.get(s,{responseType:"text"}).pipe((0,d.T)(r=>(i=r.split("\n").map(o=>{const[p,u,l,c,h]=o.split("\t");return{name:p,assayType:u,link:l,documentation:c,platform:h}}).filter(o=>"Pipeline name"!==o.name&&"Assay type"!==o.assayType),i)),(0,m.L)(1),(0,g.W)(r=>{if(!(r.error instanceof ErrorEvent))return 404===r.status?xt.w.pipe((0,d.T)(()=>[])):(0,pt.$)("Something bad happened; please try again later.")}))}getAllArticles(e,s){const i=`${this.hostSetting.host}data/article/_search/?size=${s}`,r={year:"year",journal:"journal",datasetSource:"datasetSource",project:"secondaryProject",source:"source"},n={title:"title",year:"year",journal:"journal",datasetSource:"datasetSource",source:"source"},o=e.filters;for(const c of Object.keys(o))r[c]&&c!==r[c]&&(o[r[c]]=o[c],delete o[c]);this.apiFiltersService.set_current_api_filters(o);const p=n[e.sort[0]]?n[e.sort[0]]+":"+e.sort[1]:e.sort[0]+":"+e.sort[1],u=(new _.Nl).set("_source",e._source.toString()).set("sort",p).set("filters",JSON.stringify(o)).set("aggs",JSON.stringify(r)).set("from_",e.from_).set("search",e.search),l={};return this.http.get(i,{params:u}).pipe((0,d.T)(c=>(l.data=c.hits.hits.map(h=>({id:h._id,title:h._source.title,year:h._source.year,journal:h._source.journal,datasetSource:h._source.datasetSource,source:h._source.source})),l.totalHits=c.hits.total.value,l.aggregations=c.aggregations,l)),(0,m.L)(3),(0,g.W)(this.handleError))}getArticle(e){const s=`${this.hostSetting.host}data/article/${e}`;return this.http.get(s).pipe((0,m.L)(3),(0,g.W)(this.handleError))}getAllSamplesProtocols(e,s){const i=`${this.hostSetting.host}data/protocol_samples/_search/?size=${s}`,r={university_name:"universityName",protocol_date:"protocolDate",project:"secondaryProject"},n={key:"key",protocol_name:"protocolName",university_name:"universityName",protocol_date:"protocolDate"},o=e.filters;for(const c of Object.keys(o))r[c]&&c!==r[c]&&(o[r[c]]=o[c],delete o[c]);this.apiFiltersService.set_current_api_filters(o);const p=n[e.sort[0]]?n[e.sort[0]]+":"+e.sort[1]:e.sort[0]+":"+e.sort[1],u=(new _.Nl).set("_source",e._source.toString()).set("sort",p).set("filters",JSON.stringify(o)).set("aggs",JSON.stringify(r)).set("from_",e.from_).set("search",e.search),l={};return this.http.get(i,{params:u}).pipe((0,d.T)(c=>(l.data=c.hits.hits.map(h=>({key:h._source.key,protocol_name:h._source.protocolName,university_name:h._source.universityName,protocol_date:h._source.protocolDate})),l.totalHits=c.hits.total.value,l.aggregations=c.aggregations,l)),(0,m.L)(3),(0,g.W)(this.handleError))}getSampleProtocol(e){const s=`${this.hostSetting.host}data/protocol_samples/${encodeURIComponent(e)}`;return this.http.get(s).pipe((0,d.T)(i=>i),(0,m.L)(3),(0,g.W)(this.handleError))}getAllAnalysisProtocols(e,s){const i=`${this.hostSetting.host}data/protocol_analysis/_search/?size=${s}`,r={university_name:"universityName",protocol_date:"protocolDate",project:"secondaryProject"},n={key:"key",protocol_name:"protocolName",university_name:"universityName",protocol_date:"protocolDate"},o=e.filters;for(const c of Object.keys(o))r[c]&&c!==r[c]&&(o[r[c]]=o[c],delete o[c]);this.apiFiltersService.set_current_api_filters(o);const p=n[e.sort[0]]?n[e.sort[0]]+":"+e.sort[1]:e.sort[0]+":"+e.sort[1],u=(new _.Nl).set("_source",e._source.toString()).set("sort",p).set("filters",JSON.stringify(o)).set("aggs",JSON.stringify(r)).set("from_",e.from_).set("search",e.search),l={};return this.http.get(i,{params:u}).pipe((0,d.T)(c=>(l.data=c.hits.hits.map(h=>({key:h._source.key,protocol_name:h._source.protocolName,university_name:h._source.universityName,protocol_date:h._source.protocolDate})),l.totalHits=c.hits.total.value,l.aggregations=c.aggregations,l)),(0,m.L)(3),(0,g.W)(this.handleError))}getAnalysisProtocol(e){const s=`${this.hostSetting.host}data/protocol_analysis/${encodeURIComponent(e)}`;return this.http.get(s).pipe((0,d.T)(i=>i),(0,m.L)(3),(0,g.W)(this.handleError))}getAllExperimentsProtocols(e,s){const i=`${this.hostSetting.host}data/protocol_files/_search/?size=${s}`,r={protocol_type:"name",experiment_target:"experimentTarget",assay_type:"assayType",project:"secondaryProject"},n={key:"key",protocol_type:"name",experiment_target:"experimentTarget",assay_type:"assayType"},o=e.filters;for(const c of Object.keys(o))r[c]&&c!==r[c]&&(o[r[c]]=o[c],delete o[c]);this.apiFiltersService.set_current_api_filters(o);const p=n[e.sort[0]]?n[e.sort[0]]+":"+e.sort[1]:e.sort[0]+":"+e.sort[1],u=(new _.Nl).set("_source",e._source.toString()).set("sort",p).set("filters",JSON.stringify(o)).set("aggs",JSON.stringify(r)).set("from_",e.from_).set("search",e.search),l={};return this.http.get(i,{params:u}).pipe((0,d.T)(c=>(l.data=c.hits.hits.map(h=>({key:h._source.key,protocol_type:U[h._source.name]?U[h._source.name]:h._source.name,experiment_target:h._source.experimentTarget,assay_type:h._source.assayType})),l.totalHits=c.hits.total.value,l.aggregations=c.aggregations,l)),(0,m.L)(3),(0,g.W)(this.handleError))}getExperimentProtocol(e){const s=`${this.hostSetting.host}data/protocol_files/${encodeURIComponent(e)}`;return this.http.get(s).pipe((0,d.T)(i=>i),(0,m.L)(3),(0,g.W)(this.handleError))}getOrganismSummary(e){const s=`${this.hostSetting.host}data/summary_organism/${e}`;return this.http.get(s).pipe((0,d.T)(i=>i),(0,m.L)(3),(0,g.W)(this.handleError))}getSpecimenSummary(e){const s=`${this.hostSetting.host}data/summary_specimen/${e}`;return this.http.get(s).pipe((0,d.T)(i=>i),(0,m.L)(3),(0,g.W)(this.handleError))}getDatasetSummary(e){const s=`${this.hostSetting.host}data/summary_dataset/${e}`;return this.http.get(s).pipe((0,d.T)(i=>i),(0,m.L)(3),(0,g.W)(this.handleError))}getFileSummary(e){const s=`${this.hostSetting.host}data/summary_file/${e}`;return this.http.get(s).pipe((0,d.T)(i=>i),(0,m.L)(3),(0,g.W)(this.handleError))}getRulesetSample(e){let s;"standard"===e?(s="core",e="core"):-1!==e.indexOf("teleostei")?(s="module",e=e.replace("teleostei","teleost")):(s="type","specimen_standard_rules"===e&&(e="specimen"));const i=Z+`${s}/samples/faang_samples_${e}.metadata_rules.json`;return this.http.get(i).pipe((0,d.T)(r=>r),(0,g.W)(this.handleError))}getRulesetExperiment(e){let s;"standard"===e?(s="core",e="core"):"chip-seq_dna-binding_proteins"===e||"chip-seq_input_dna"===e?s="module":(s="type","chip-seq_standard_rules"===e&&(e="chip-seq"));const i=Z+`${s}/experiments/faang_experiments_${e}.metadata_rules.json`;return this.http.get(i).pipe((0,d.T)(r=>r),(0,g.W)(this.handleError))}getRulesetAnalysis(e){let s;s="eva"===e?"module":"type";const i=Z+`${s}/analyses/faang_analyses_${e}.metadata_rules.json`;return this.http.get(i).pipe((0,d.T)(r=>r),(0,g.W)(this.handleError))}startValidation(e,s,i,r){const n=$+"/validation/"+e+"/"+r+"/"+s+"/"+i;return this.http.get(n)}startConversion(e,s,i){const r=$+"/submission/"+i+"/"+e+"/"+s;return this.http.get(r)}getTemplate(e,s,i,r){const n=`${$}/submission/get_template/${e}/${s}/${i}/${r}`;return this.http.get(n)}chooseDomain(e,s,i,r,n){const o=`${$}/submission/samples/${r}/choose_domain`;return this.http.post(o,{username:e,password:s,mode:i,private_submission:n})}submitDomain(e,s,i,r,n,o,p){const u=`${$}/submission/samples/${o}/submit_domain`;return this.http.post(u,{username:e,password:s,mode:i,domain_name:r,domain_description:n,private_submission:p})}submitRecords(e,s,i,r,n,o,p,u,l=""){const c=`${$}/submission/${e}/${p}/${o}/${n}/submit_records`;return""!==l?this.http.post(c,{username:s,password:i,mode:r,domain_name:l,private_submission:u}):this.http.post(c,{username:s,password:i,mode:r,private_submission:u})}get_pubsub_messages(){const e=`${this.hostSetting.host}data/submission_portal_status/_search/?size=1`;return this.http.get(e).pipe((0,d.T)(i=>i.hits.hits.map(n=>({enaStatus:n._source.ena_status,biosampleStatus:n._source.biosample_status}))),(0,m.L)(3),(0,g.W)(this.handleError))}subscribeUser(e,s,i,r){const n=`${this.hostSetting.host}submission/submission_subscribe_faang/${e}/${s}/${i}`,o=(new _.Nl).set("filters",JSON.stringify(r));return this.http.get(n,{params:o})}subscribeFilteredData(e,s,i){const r=this.apiFiltersService.get_current_api_filters(),n=`${this.hostSetting.host}submission/submission_subscribe_faang/${e}/${s}/${i}`,o=(new _.Nl).set("filters",JSON.stringify(r));return this.http.get(n,{params:o})}handleError(e){return e.error instanceof ErrorEvent?console.error("An errorSubject occurred:",e.error.message):(console.error(`Backend returned code ${e.status}, body was: ${e.error}`),console.error(e)),(0,pt.$)(e)}static#t=this.\u0275fac=function(s){return new(s||k)(t.KVO(_.Qq),t.KVO(A),t.KVO(E))};static#e=this.\u0275prov=t.jDH({token:k,factory:k.\u0275fac,providedIn:"root"})}var tt=f(7984),j=f(4950);const Pt=["subscriptionTemplate"],Tt=["subscriptionInfoTemplate"];function $t(a,e){if(1&a&&(t.j41(0,"th",14),t.EFF(1),t.k0s()),2&a){const s=t.XpG(2).index,i=t.XpG();t.R7$(),t.SpI(" ",i.column_names[s]," ")}}function Et(a,e){if(1&a&&(t.j41(0,"td",15),t.EFF(1),t.nI1(2,"json"),t.k0s()),2&a){const s=t.XpG(2).$implicit;t.R7$(),t.SpI(" ",t.bMT(2,1,s),"\n")}}function Ct(a,e){1&a&&(t.qex(0),t.DNE(1,$t,2,1,"th",12)(2,Et,3,3,"td",13),t.bVm())}function wt(a,e){if(1&a&&(t.j41(0,"th",14),t.EFF(1),t.k0s()),2&a){const s=t.XpG(2).index,i=t.XpG();t.R7$(),t.SpI(" ",i.column_names[s]," ")}}function Ot(a,e){if(1&a){const s=t.RV6();t.qex(0),t.j41(1,"div")(2,"button",17),t.bIt("click",function(){t.eBV(s);const r=t.XpG().$implicit,n=t.XpG(3);return t.Njj(n.openSubscriptionDialog(r[n.apiKey]))}),t.j41(3,"mat-icon",18),t.EFF(4,"email"),t.k0s()()(),t.bVm()}}function At(a,e){if(1&a&&t.EFF(0),2&a){const s=t.XpG().$implicit,i=t.XpG(2).$implicit;t.SpI(" ",s[i]," ")}}function Rt(a,e){if(1&a&&(t.j41(0,"td",15),t.DNE(1,Ot,5,0,"ng-container",16)(2,At,1,1,"ng-template",null,2,t.C5r),t.k0s()),2&a){const s=t.sdS(3),i=t.XpG(2).$implicit;t.R7$(),t.Y8G("ngIf","subscribe"===i)("ngIfElse",s)}}function Lt(a,e){1&a&&(t.qex(0),t.DNE(1,wt,2,1,"th",12)(2,Rt,4,2,"td",13),t.bVm())}function Nt(a,e){if(1&a&&(t.qex(0,10),t.DNE(1,Ct,3,0,"ng-container",11)(2,Lt,3,0,"ng-container",11),t.bVm()),2&a){const s=e.$implicit,i=t.XpG();t.Y8G("matColumnDef",s),t.R7$(),t.Y8G("ngIf",i.templates[s]),t.R7$(),t.Y8G("ngIf",!i.templates[s])}}function Gt(a,e){1&a&&t.nrm(0,"tr",19)}function It(a,e){1&a&&t.nrm(0,"tr",20)}function Dt(a,e){1&a&&(t.j41(0,"mat-error"),t.EFF(1," Email is required "),t.k0s())}function Mt(a,e){1&a&&(t.j41(0,"mat-error"),t.EFF(1," Please enter a valid email "),t.k0s())}function zt(a,e){if(1&a){const s=t.RV6();t.j41(0,"div",21)(1,"p",22),t.EFF(2),t.k0s(),t.j41(3,"form",23)(4,"p")(5,"mat-form-field",24)(6,"input",25),t.bIt("input",function(r){t.eBV(s);const n=t.XpG();return t.Njj(n.getEmail(r))}),t.k0s(),t.j41(7,"mat-hint",26),t.EFF(8,"Enter a valid email address."),t.k0s(),t.DNE(9,Dt,2,0,"mat-error",11)(10,Mt,2,0,"mat-error",11),t.k0s()()(),t.j41(11,"div",27)(12,"button",28),t.bIt("click",function(){t.eBV(s);const r=t.XpG();return t.Njj(r.onCancelDialog("form"))}),t.EFF(13,"Cancel"),t.k0s(),t.j41(14,"button",29),t.bIt("click",function(){const r=t.eBV(s).$implicit,n=t.XpG();return t.Njj(n.onRegister(r))}),t.EFF(15,"Register"),t.k0s()()()}if(2&a){const s=t.XpG();t.R7$(2),t.JRh(s.subscriptionDialogTitle),t.R7$(),t.Y8G("formGroup",s.subscriptionForm),t.R7$(2),t.xc7("width",100,"%"),t.R7$(4),t.Y8G("ngIf",s.displayError("subscriberEmail","required")),t.R7$(),t.Y8G("ngIf",s.displayError("subscriberEmail","email"))}}function Ut(a,e){if(1&a){const s=t.RV6();t.j41(0,"div",21)(1,"div",30)(2,"div",31),t.EFF(3),t.k0s()()(),t.j41(4,"div",27)(5,"button",28),t.bIt("click",function(){t.eBV(s);const r=t.XpG();return t.Njj(r.onCancelDialog("info"))}),t.EFF(6,"Close"),t.k0s()()}if(2&a){const s=t.XpG();t.R7$(),t.Y8G("ngClass","success"==s.subscription_status?"alert alert-success":"alert alert-warning"),t.R7$(2),t.SpI(" ",s.submission_message," ")}}class R{constructor(e,s,i,r,n,o){this.spinner=e,this.activatedRoute=s,this.router=i,this.dialog=r,this.dataService=n,this.dataUpdate=new t.bkB,this.sortUpdate=new t.bkB,this.subscriptionTemplate={},this.subscriptionInfoTemplate={},this.dataSource=new F.I6,this.totalHits=0,this.delaySearch=!0,this.subscriber={email:"",filters:{}},this.currentSearchTerm="",this.queryParams={},this.specialFilters={paper_published:[{filterValue:["true"],displayValue:"Yes"},{filterValue:["false"],displayValue:"No"}],sex:[{filterValue:nt,displayValue:"male"},{filterValue:ct,displayValue:"female"}],source:[{filterValue:["PPR"],displayValue:"preprint"},{filterValue:lt,displayValue:"published"}],assayType:[{filterValue:["transcription profiling by high throughput sequencing"],displayValue:"RNA-Seq"}]},this.displayError=(p,u)=>this.subscriptionForm.controls[p].hasError(u),this.location=o}ngOnInit(){this.subscriptionForm=new b.gE({subscriberEmail:new b.MJ("",[b.k0.required,b.k0.email])}),this.currentSearchTerm=this.query.search,this.activatedRoute.queryParams.subscribe(e=>{this.queryParams={...e}}),this.queryParams.sortTerm&&this.queryParams.sortDirection&&(this.sort.active=this.queryParams.sortTerm,this.sort.direction=this.queryParams.sortDirection),this.queryParams.pageIndex&&this.resetPagination(this.queryParams.pageIndex)}ngAfterViewInit(){this.indexDetails&&(this.apiKey=this.indexDetails.apiKey,this.setSocket()),this.sort.sortChange.subscribe(()=>this.paginator.pageIndex=0),(0,ft.h)(this.sort.sortChange,this.paginator.page).pipe((0,bt.Z)({}),(0,vt.n)(()=>(this.spinner.show(),this.sort.active&&this.sort.direction?(this.query.sort=[this.sort.active,this.sort.direction],this.sortUpdate.emit(this.query.sort)):this.query.sort=this.defaultSort,this.updateSortingUrlParameters(this.query.sort[0],this.query.sort[1]),this.query.from_=this.paginator.pageIndex*this.paginator.pageSize,this.apiFunction(this.query,25))),(0,d.T)(e=>e),(0,g.W)(()=>(this.spinner.hide(),(0,_t.of)([])))).subscribe(e=>{this.dataSource.data=e.data,this.dataUpdate.emit(e),this.totalHits=e.totalHits,this.spinner.hide()})}ngOnChanges(){this.dataSource&&(this.spinner.show(),this.paginator.pageIndex=0,this.sort.active&&this.sort.direction?(this.query.sort=[this.sort.active,this.sort.direction],this.sortUpdate.emit(this.query.sort)):this.query.sort=this.defaultSort,this.updateSortingUrlParameters(this.query.sort[0],this.query.sort[1]),this.sortUpdate.emit(this.query.sort),this.query.from_=0,this.updateUrlCodeFilters(),this.apiFunction(this.query,25).subscribe(e=>{this.dataSource.data=e.data,this.dataUpdate.emit(e),this.totalHits=e.totalHits,this.spinner.hide()}))}searchChanged(e){const s=e.target.value.trim().toLowerCase();this.delaySearch?(this.timer&&clearTimeout(this.timer),this.timer=setTimeout(this.applySearchFilter.bind(this),500,s)):this.applySearchFilter(s)}applySearchFilter(e){this.paginator.pageIndex=0,this.query.from_=0,this.query.search=e,this.spinner.show(),this.apiFunction(this.query,25).subscribe(s=>{this.dataSource.data=s.data,this.dataUpdate.emit(s),this.totalHits=s.totalHits,this.spinner.hide()}),this.updateUrlParameters(e,"searchTerm")}updateSortingUrlParameters(e,s){this.updateUrlParameters(e,"sortTerm"),this.updateUrlParameters(s,"sortDirection")}updateUrlParameters(e,s){e?this.queryParams[s]=e:s in this.queryParams&&delete this.queryParams[s],this.router.navigate([],{relativeTo:this.activatedRoute,queryParams:this.queryParams,replaceUrl:!0,skipLocationChange:!1})}openSubscriptionDialog(e){this.subscriptionDialogTitle=`Subscribing to record ${e}`,this.subscriber.filters[this.indexDetails.indexKey]=[e],this.dialogRef=this.dialog.open(this.subscriptionTemplate,{data:this.subscriber,height:"260px",width:"400px"})}onCancelDialog(e){"info"===e?this.dialogSubscriptionInfoRef.close():this.dialogRef.close()}getEmail(e){this.subscriber.email=e.target.value}onRegister(e){this.subscriptionForm.valid&&this.subscriptionForm.touched&&this.dataService.subscribeUser(this.indexDetails.index,this.indexDetails.indexKey,e.email,e.filters).subscribe(s=>{this.dialogRef.close()},s=>{console.log(s),this.dialogRef.close()})}setSocket(){const e=`wss://api.faang.org/ws/submission/subscription_${this.indexDetails.index}/`;this.socket=new WebSocket(e),this.socket.onopen=()=>{console.log("WebSockets connection created.")},this.socket.onmessage=s=>{const i=JSON.parse(s.data).response;i.submission_message&&(this.dialogRef&&(this.dialogRef.close(),this.dialogRef.afterClosed().pipe((0,St.j)(()=>this.dialogRef=void 0))),this.submission_message=i.submission_message,this.subscription_status=i.subscription_status,this.subscription_status&&(this.dialogSubscriptionInfoRef=this.dialog.open(this.subscriptionInfoTemplate,{data:this.subscriber,height:"250px",width:"600px"})))},this.socket.readyState===WebSocket.OPEN&&this.socket.onopen(null)}resetPagination(e){0!=e&&(this.queryParams.pageIndex=e,this.paginator.pageIndex=e,this.paginator.page.next({pageIndex:this.paginator.pageIndex,pageSize:this.paginator.pageSize,length:this.paginator.length}))}updateUrlCodeFilters(){for(const e in this.query.filters)if(Array.isArray(this.query.filters[e])){let s=[];this.query.filters[e].forEach((i,r)=>{const n=this.getFilterCodeValue(e,i);n&&(s=s.concat(n))}),this.query.filters[e]=s}}getFilterCodeValue(e,s){if(e in this.specialFilters){const i=this.specialFilters[e].filter(r=>r.displayValue==s);if(i.length>0)return i[0].filterValue}return[s]}onPageChange(e){const s={pageIndex:this.paginator.pageIndex};this.urlTree=this.router.createUrlTree([],{relativeTo:this.activatedRoute,queryParams:s,queryParamsHandling:"merge"}).toString(),this.location.go(this.urlTree)}ngDoCheck(){this.urlTree&&this.location.go(this.urlTree),this.urlTree=""}static#t=this.\u0275fac=function(s){return new(s||R)(t.rXU(J.ex),t.rXU(S.nX),t.rXU(S.Ix),t.rXU(y.bZ),t.rXU(k),t.rXU(v.aZ))};static#e=this.\u0275cmp=t.VBU({type:R,selectors:[["app-table-server-side"]],viewQuery:function(s,i){if(1&s&&(t.GBs(Q.iy,7),t.GBs(z.B4,7),t.GBs(Pt,5),t.GBs(Tt,5)),2&s){let r;t.mGM(r=t.lsd())&&(i.paginator=r.first),t.mGM(r=t.lsd())&&(i.sort=r.first),t.mGM(r=t.lsd())&&(i.subscriptionTemplate=r.first),t.mGM(r=t.lsd())&&(i.subscriptionInfoTemplate=r.first)}},inputs:{display_fields:"display_fields",column_names:"column_names",templates:"templates",filter_values:"filter_values",apiFunction:"apiFunction",query:"query",defaultSort:"defaultSort",indexDetails:"indexDetails"},outputs:{dataUpdate:"dataUpdate",sortUpdate:"sortUpdate"},features:[t.OA$],decls:13,vars:6,consts:[["subscriptionTemplate",""],["subscriptionInfoTemplate",""],["defaultDisplay",""],[2,"width","100%","margin-top","10px"],["matInput","","name","searchField","placeholder","Search",3,"keyup","ngModelChange","ngModel"],["mat-table","","matSort","","table-striped","",2,"width","100%",3,"dataSource"],[3,"matColumnDef",4,"ngFor","ngForOf"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["pageSize","25",3,"page","length"],[3,"matColumnDef"],[4,"ngIf"],["mat-header-cell","","class","table-header","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","","class","table-cell-data","style","padding-right: 5px; max-width: 150px",4,"matCellDef"],["mat-header-cell","","mat-sort-header","",1,"table-header"],["mat-cell","",1,"table-cell-data",2,"padding-right","5px","max-width","150px"],[4,"ngIf","ngIfElse"],["mat-icon-button","",3,"click"],[1,"subscription-icon"],["mat-header-row",""],["mat-row",""],["mat-dialog-content","",1,"centerContents"],[1,"mat-dialog-title-font"],["novalidate","",3,"formGroup"],["appearance","fill"],["matInput","","placeholder","Enter email","formControlName","subscriberEmail","id","subscriberEmail",3,"input"],["align","end"],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-button","","cdkFocusInitial","",3,"click"],["fxLayout","row",3,"ngClass"],["fxFlex","100"]],template:function(s,i){if(1&s){const r=t.RV6();t.j41(0,"mat-form-field",3)(1,"mat-label"),t.EFF(2,"Search"),t.k0s(),t.j41(3,"input",4),t.bIt("keyup",function(o){return t.eBV(r),t.Njj(i.searchChanged(o))}),t.mxI("ngModelChange",function(o){return t.eBV(r),t.DH7(i.currentSearchTerm,o)||(i.currentSearchTerm=o),t.Njj(o)}),t.k0s()(),t.j41(4,"table",5),t.DNE(5,Nt,3,3,"ng-container",6)(6,Gt,1,0,"tr",7)(7,It,1,0,"tr",8),t.k0s(),t.j41(8,"mat-paginator",9),t.bIt("page",function(o){return t.eBV(r),t.Njj(i.onPageChange(o))}),t.k0s(),t.DNE(9,zt,16,6,"ng-template",null,0,t.C5r)(11,Ut,7,2,"ng-template",null,1,t.C5r)}2&s&&(t.R7$(3),t.R50("ngModel",i.currentSearchTerm),t.R7$(),t.Y8G("dataSource",i.dataSource),t.R7$(),t.Y8G("ngForOf",i.display_fields),t.R7$(),t.Y8G("matHeaderRowDef",i.display_fields),t.R7$(),t.Y8G("matRowDefColumns",i.display_fields),t.R7$(),t.Y8G("length",i.totalHits))},dependencies:[v.YU,v.Sq,v.bT,b.qT,b.me,b.BC,b.cb,b.vS,F.Zl,F.tL,F.ji,F.cC,F.YV,F.iL,F.KS,F.$R,F.YZ,F.NB,Q.iy,z.B4,z.aE,T.$z,T.iY,I.An,tt.fg,j.rl,j.nJ,j.MV,j.TL,y.E7,y.Yi,b.j4,b.JD,v.TG],styles:[".table-header[_ngcontent-%COMP%]{background-color:#00000012;font-size:14px;color:#000;font-weight:600}.table-cell-data[_ngcontent-%COMP%]{padding-right:12px!important}td.mat-cell[_ngcontent-%COMP%]:first-of-type, td.mat-footer-cell[_ngcontent-%COMP%]:first-of-type, th.mat-header-cell[_ngcontent-%COMP%]:first-of-type{padding-left:10px}.subscription-icon[_ngcontent-%COMP%]{color:#4682b4}div.mat-dialog-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0 auto;display:block}\n\n/*# sourceMappingURL=table-server-side.component.css.map*/"]})}function Yt(a,e){1&a&&(t.j41(0,"mat-error"),t.EFF(1," Email is required "),t.k0s())}function Vt(a,e){1&a&&(t.j41(0,"mat-error"),t.EFF(1," Please enter a valid email "),t.k0s())}class Y{constructor(e,s,i){this.dataService=e,this.dialogRef=s,this.data=i,this.email="",this.title="",this.displayError=(r,n)=>this.subscriptionForm.controls[r].hasError(n),this.inputData={...i},this.subscriptionDialogTitle=this.inputData.title}ngOnInit(){this.subscriptionForm=new b.gE({subscriberEmail:new b.MJ("",[b.k0.required,b.k0.email])})}onCancelDialog(e){this.dialogRef.close()}onRegister(){this.subscriptionForm.valid&&this.subscriptionForm.touched&&this.dataService.subscribeFilteredData(this.inputData.indexName,this.inputData.indexKey,this.inputData.email).subscribe(e=>{console.log("You have now been subscribed!"),this.dialogRef.close()},e=>{console.log(e),this.dialogRef.close()})}static#t=this.\u0275fac=function(s){return new(s||Y)(t.rXU(k),t.rXU(y.CP),t.rXU(y.Vh))};static#e=this.\u0275cmp=t.VBU({type:Y,selectors:[["app-subscription-dialog"]],decls:16,vars:7,consts:[["mat-dialog-content","",1,"centerContents"],[1,"mat-dialog-title-font"],["novalidate","",3,"formGroup"],["appearance","fill"],["matInput","","placeholder","Enter email","formControlName","subscriberEmail","id","subscriberEmail",3,"ngModelChange","ngModel"],["align","end"],[4,"ngIf"],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-button","","cdkFocusInitial","",3,"click"]],template:function(s,i){1&s&&(t.j41(0,"div",0)(1,"p",1),t.EFF(2),t.k0s(),t.j41(3,"form",2)(4,"p")(5,"mat-form-field",3)(6,"input",4),t.mxI("ngModelChange",function(n){return t.DH7(i.inputData.email,n)||(i.inputData.email=n),n}),t.k0s(),t.j41(7,"mat-hint",5),t.EFF(8,"Enter a valid email address."),t.k0s(),t.DNE(9,Yt,2,0,"mat-error",6)(10,Vt,2,0,"mat-error",6),t.k0s()()(),t.j41(11,"div",7)(12,"button",8),t.bIt("click",function(){return i.onCancelDialog("form")}),t.EFF(13,"Cancel"),t.k0s(),t.j41(14,"button",9),t.bIt("click",function(){return i.onRegister()}),t.EFF(15,"Register"),t.k0s()()()),2&s&&(t.R7$(2),t.JRh(i.subscriptionDialogTitle),t.R7$(),t.Y8G("formGroup",i.subscriptionForm),t.R7$(2),t.xc7("width",100,"%"),t.R7$(),t.R50("ngModel",i.inputData.email),t.R7$(3),t.Y8G("ngIf",i.displayError("subscriberEmail","required")),t.R7$(),t.Y8G("ngIf",i.displayError("subscriberEmail","email")))},dependencies:[v.bT,b.qT,b.me,b.BC,b.cb,T.$z,tt.fg,j.rl,j.MV,j.TL,y.E7,y.Yi,b.j4,b.JD]})}class x{constructor(){this.active_filters={standard:[],study:[],species:[],assayType:[],target:[],instrument:[],sex:[],organism:[],datasetAccession:[],analysisType:[],breed:[],material:[],organismpart_celltype:[],archive:[],protocol_name:[],university_name:[],protocol_date:[],protocol_type:[],name:[],experimentTarget:[],paper_published:[],year:[],journal:[],source:[],datasetSource:[],project:[],type:[],projects:[],status_activity:[]},this.protocolNames=U,this.current_active_filters=[],this.data=new q.B,this.field=new q.B}getHumanName(e){return this.protocolNames[e]}getHumanReadableValue(e){return e.split(/(?=[A-Z])/).join(" ").toLowerCase()}updateAggregation(e,s){return e.hasOwnProperty(s)?e[s]+=1:e[s]=1,e}updateAggregationCommaSeparated(e,s){return s.split(", ").forEach(r=>{e.hasOwnProperty(r)?e[r]+=1:e[r]=1}),e}getAggregations(e,s){if("file"===s||"organism"===s||"specimen"===s||"dataset"===s||"analysis"===s||"protocol"===s||"protocol_experiments"===s||"article"===s||"ontology"===s){let i={};for(const n in e)i[n]={},e[n].buckets?e[n].buckets.forEach(o=>{o.key&&(i[n][o.key]=o.doc_count)}):i[n]=e[n].doc_count;let r=!1;for(let n in i){if(("paper_published"==n||"paper_published_missing"==n)&&!r){let o={Yes:0,No:0};for(const p in i.paper_published)"true"==p?o.Yes+=i.paper_published[p]:o.No+=i.paper_published[p];i.paper_published_missing&&(o.No+=i.paper_published_missing);for(const p in o)0==o[p]&&delete o[p];i.paper_published=o,r=!0}if("assay_type"==n)for(const o in i.assay_type)if("transcription profiling by high throughput sequencing"==o){i.assay_type["RNA-Seq"]=i.assay_type[o],delete i.assay_type[o];break}if("sex"==n){let o={male:0,female:0};for(const p in i.sex)nt.indexOf(p)>-1?o.male+=i.sex[p]:ct.indexOf(p)>-1?o.female+=i.sex[p]:o[p]=i.sex[p];for(const p in o)0==o[p]&&delete o[p];i.sex=o}if("source"===n){const o={published:0,preprint:0};for(const p in i.source)"PPR"===p.toUpperCase()?o.preprint+=i.source[p]:lt.indexOf(p.toUpperCase())>-1?o.published+=i.source[p]:o[p]=i.source[p];for(const p in o)0===o[p]&&delete o[p];i.source=o}if("analysis_type"==n||"experiment_target"==n)for(const o in i[n])i[n][ut(o)]=i[n][o],delete i[n][o];if("protocol_type"==n)for(const o in i[n])i.protocol_type[this.getHumanName(o)]=i[n][o],delete i[n][o];if("type"==n)for(const o in i[n])i.type[this.getHumanReadableValue(o)]=i[n][o],delete i[n][o];i[n]=Object.entries(i[n]).sort(function(o,p){return p[1]-o[1]})}this.data.next(i)}}updatePaperAggregation(e,s){return e="true"===s?this.updateAggregation(e,"Yes"):this.updateAggregation(e,"No")}static#t=this.\u0275fac=function(s){return new(s||x)};static#e=this.\u0275prov=t.jDH({token:x,factory:x.\u0275fac,providedIn:"root"})}class L{constructor(e,s){this.aggregationService=e,this.router=s}updateUrlParams(e,s){return this.aggregationService.field.subscribe(r=>{const n={};for(const o of Object.keys(r))r[o]&&0!==r[o].length&&(n[o]=r[o]);e.search&&(n.searchTerm=e.search),e.sort&&(n.sortTerm=e.sort[0],n.sortDirection=e.sort[1]),this.router.navigate(s,{queryParams:n,replaceUrl:!0,skipLocationChange:!1})})}setUpAggregationFilters(e){const s={};for(const i in e)if("searchTerm"!==i&&"sortTerm"!==i&&"sortDirection"!==i&&"pageIndex"!==i)if(Array.isArray(e[i])){s[i]=e[i];for(const r of e[i])this.aggregationService.current_active_filters.push(r),this.aggregationService.active_filters[i].push(r)}else s[i]=[e[i]],this.aggregationService.current_active_filters.push(e[i]),this.aggregationService.active_filters[i].push(e[i]);return this.aggregationService.field.next(this.aggregationService.active_filters),s}resetFilter(){for(const e of Object.keys(this.aggregationService.active_filters))this.aggregationService.active_filters[e]=[];this.aggregationService.current_active_filters=[]}static#t=this.\u0275fac=function(s){return new(s||L)(t.KVO(x),t.KVO(S.Ix))};static#e=this.\u0275prov=t.jDH({token:L,factory:L.\u0275fac,providedIn:"root"})}var gt=f(640),mt=f(1134);const et=a=>({"long-list":a}),st=a=>({active:a});function Ht(a,e){if(1&a){const s=t.RV6();t.j41(0,"i",5),t.bIt("click",function(){t.eBV(s);const r=t.XpG(2);return t.Njj(r.toggleCollapse())}),t.EFF(1,"add"),t.k0s()}}function Bt(a,e){if(1&a){const s=t.RV6();t.j41(0,"i",5),t.bIt("click",function(){t.eBV(s);const r=t.XpG(2);return t.Njj(r.toggleCollapse())}),t.EFF(1,"remove"),t.k0s()}}function Wt(a,e){if(1&a){const s=t.RV6();t.j41(0,"div",9),t.bIt("click",function(){t.eBV(s);const r=t.XpG().$implicit,n=t.XpG(3);return t.Njj(n.onButtonClick(r[0],n.title))}),t.EFF(1),t.j41(2,"span",10),t.EFF(3),t.k0s()()}if(2&a){const s=t.XpG().$implicit,i=t.XpG(3);t.Y8G("ngClass",t.eq3(3,st,i.aggregationService.current_active_filters&&i.aggregationService.current_active_filters.indexOf(s[0])>-1)),t.R7$(),t.SpI(" ",s[0]," "),t.R7$(2),t.JRh(s[1])}}function Xt(a,e){if(1&a&&(t.qex(0),t.DNE(1,Wt,4,5,"div",8),t.bVm()),2&a){const s=e.$implicit,i=e.index,r=t.XpG(3);t.R7$(),t.Y8G("ngIf",i<r.itemLimit&&""!=s[0])}}function Jt(a,e){if(1&a&&(t.j41(0,"div",6),t.DNE(1,Xt,2,1,"ng-container",7),t.k0s()),2&a){const s=t.XpG(2);t.Y8G("ngClass",t.eq3(2,et,s.itemLimit>s.filterSize)),t.R7$(),t.Y8G("ngForOf",s.aggregation)}}function Kt(a,e){if(1&a){const s=t.RV6();t.j41(0,"div",9),t.bIt("click",function(){t.eBV(s);const r=t.XpG().$implicit,n=t.XpG(3);return t.Njj(n.onButtonClick(r[0],n.title))}),t.EFF(1),t.j41(2,"span",10),t.EFF(3),t.k0s()()}if(2&a){const s=t.XpG().$implicit,i=t.XpG(3);t.Y8G("ngClass",t.eq3(3,st,i.aggregationService.current_active_filters&&i.aggregationService.current_active_filters.indexOf(i.getReverseHumanName(s[0]))>-1)),t.R7$(),t.SpI(" ",s[0]," "),t.R7$(2),t.JRh(s[1])}}function Qt(a,e){if(1&a&&(t.qex(0),t.DNE(1,Kt,4,5,"div",8),t.bVm()),2&a){const s=e.$implicit,i=e.index,r=t.XpG(3);t.R7$(),t.Y8G("ngIf",i<r.itemLimit&&""!=s[0])}}function Zt(a,e){if(1&a&&(t.j41(0,"div",6),t.DNE(1,Qt,2,1,"ng-container",7),t.k0s()),2&a){const s=t.XpG(2);t.Y8G("ngClass",t.eq3(2,et,s.itemLimit>s.filterSize)),t.R7$(),t.Y8G("ngForOf",s.aggregation)}}function qt(a,e){if(1&a){const s=t.RV6();t.j41(0,"div",9),t.bIt("click",function(){t.eBV(s);const r=t.XpG().$implicit,n=t.XpG(3);return t.Njj(n.onButtonClick(r[0],n.title))}),t.EFF(1),t.j41(2,"span",10),t.EFF(3),t.k0s()()}if(2&a){const s=t.XpG().$implicit,i=t.XpG(3);t.Y8G("ngClass",t.eq3(3,st,i.aggregationService.current_active_filters&&i.aggregationService.current_active_filters.indexOf(s[0].split(" ").join("_"))>-1)),t.R7$(),t.SpI(" ",s[0]," "),t.R7$(2),t.JRh(s[1])}}function te(a,e){if(1&a&&(t.qex(0),t.DNE(1,qt,4,5,"div",8),t.bVm()),2&a){const s=e.$implicit,i=e.index,r=t.XpG(3);t.R7$(),t.Y8G("ngIf",i<r.itemLimit&&""!=s[0])}}function ee(a,e){if(1&a&&(t.j41(0,"div",6),t.DNE(1,te,2,1,"ng-container",7),t.k0s()),2&a){const s=t.XpG(2);t.Y8G("ngClass",t.eq3(2,et,s.itemLimit>s.filterSize)),t.R7$(),t.Y8G("ngForOf",s.aggregation)}}function se(a,e){if(1&a&&(t.j41(0,"mat-card",1)(1,"h6",2),t.EFF(2),t.DNE(3,Ht,2,0,"i",3)(4,Bt,2,0,"i",3),t.k0s(),t.DNE(5,Jt,2,4,"div",4)(6,Zt,2,4,"div",4)(7,ee,2,4,"div",4),t.k0s()),2&a){const s=t.XpG();t.R7$(2),t.SpI(" ",s.title," "),t.R7$(),t.Y8G("ngIf",(null==s.aggregation?null:s.aggregation.length)>s.filterSize&&s.isCollapsed),t.R7$(),t.Y8G("ngIf",(null==s.aggregation?null:s.aggregation.length)>s.filterSize&&!s.isCollapsed),t.R7$(),t.Y8G("ngIf","Protocol"!==s.title&&"Experiment target"!==s.title&&"Analysis type"!==s.title),t.R7$(),t.Y8G("ngIf","Protocol"===s.title),t.R7$(),t.Y8G("ngIf","Experiment target"===s.title||"Analysis type"===s.title)}}class V{constructor(e,s){this.aggregationService=e,this.cdRef=s,this.aggregation=[],this.isCollapsed=!0,this.current_active_filters=this.aggregationService.current_active_filters}ngOnInit(){this.itemLimit=this.filterSize,this.subsription=this.aggregationService.data.subscribe(e=>{"Standard"===this.title?this.aggregation=e.standard:"Study"===this.title?this.aggregation=e.study:"Dataset"===this.title?this.aggregation=e.dataset:"Species"===this.title?this.aggregation=e.species:"Assay type"===this.title?this.aggregation=e.assay_type:"Analysis type"===this.title?this.aggregation=e.analysis_type:"Instrument"===this.title?this.aggregation=e.instrument:"Sex"===this.title?this.aggregation=e.sex:"Organism"===this.title?this.aggregation=e.organism:"Breed"===this.title?this.aggregation=e.breed:"Material"===this.title?this.aggregation=e.material:"Organism part/Cell type"===this.title?this.aggregation=e.organismpart_celltype:"Archive"===this.title?this.aggregation=e.archive:"Protocol Name"===this.title?this.aggregation=e.protocol_name:"Organisation"===this.title?this.aggregation=e.university_name:"Protocol Year"===this.title?this.aggregation=e.protocol_date:"Protocol type"===this.title||"Protocol"===this.title?this.aggregation=e.protocol_type:"Experiment target"===this.title?this.aggregation=e.experiment_target:"Target"===this.title?this.aggregation=e.target:"Paper published"===this.title?this.aggregation=e.paper_published:"Journal"===this.title?this.aggregation=e.journal:"Article Type"===this.title?this.aggregation=e.source:"Year"===this.title?this.aggregation=e.year:"Dataset source"===this.title?this.aggregation=e.datasetSource:"Ontology Type"===this.title?this.aggregation=e.type:"Project"===this.title?this.aggregation=e.project:"Projects"===this.title?this.aggregation=e.projects:"Term Status"===this.title&&(this.aggregation=e.status_activity),this.cdRef.detectChanges()})}onButtonClick(e,s){let i;switch(s){case"Standard":i="standard";break;case"Study":i="study";break;case"Dataset":i="datasetAccession";break;case"Species":i="species";break;case"Assay type":i="assayType";break;case"Analysis type":i="analysisType",e=e.split(" ").join("_");break;case"Instrument":i="instrument";break;case"Sex":i="sex";break;case"Organism":i="organism";break;case"Breed":i="breed";break;case"Material":i="material";break;case"Organism part/Cell type":i="organismpart_celltype";break;case"Archive":i="archive";break;case"Organisation":i="university_name";break;case"Protocol Year":i="protocol_date";break;case"Protocol type":i="protocol_type";break;case"Protocol":i="protocol_type",e=this.getReverseHumanName(e);break;case"Experiment target":i="experimentTarget",e=e.split(" ").join("_");break;case"Target":i="target";break;case"Paper published":i="paper_published";break;case"Journal":i="journal";break;case"Article Type":i="source";break;case"Year":i="year";break;case"Dataset source":i="datasetSource";break;case"Ontology Type":i="type",e=this.revertReadableType(e);break;case"Project":i="project";break;case"Projects":i="projects";break;case"Term Status":i="status_activity"}const r=this.aggregationService.active_filters[i].indexOf(e);r>-1?this.aggregationService.active_filters[i].splice(r,1):this.aggregationService.active_filters[i].push(e);const n=this.aggregationService.current_active_filters.indexOf(e);r>-1?this.aggregationService.current_active_filters.splice(n,1):this.aggregationService.current_active_filters.push(e),this.aggregationService.field.next(this.aggregationService.active_filters)}toggleCollapse(){this.isCollapsed?(this.itemLimit=1e4,this.isCollapsed=!1):(this.itemLimit=this.filterSize,this.isCollapsed=!0)}getReverseHumanName(e){return jt[e]}revertReadableType(e){e=e.split(" ");for(let s=1;s<e.length;s+=1)e[s]=e[s].charAt(0).toUpperCase()+e[s].slice(1);return e=e.join(""),console.log(e),e}ngOnDestroy(){this.subsription.unsubscribe()}static#t=this.\u0275fac=function(s){return new(s||V)(t.rXU(x),t.rXU(t.gRc))};static#e=this.\u0275cmp=t.VBU({type:V,selectors:[["app-filter"]],inputs:{title:"title",filterSize:"filterSize"},decls:1,vars:1,consts:[["class","filter-card",4,"ngIf"],[1,"filter-card"],[1,"filter-header","item"],["class","material-icons float-right",3,"click",4,"ngIf"],[3,"ngClass",4,"ngIf"],[1,"material-icons","float-right",3,"click"],[3,"ngClass"],[4,"ngFor","ngForOf"],["class","d-flex justify-content-between align-items-center item",3,"ngClass","click",4,"ngIf"],[1,"d-flex","justify-content-between","align-items-center","item",3,"click","ngClass"],[1,"badge","badge-secondary","badge-pill"]],template:function(s,i){1&s&&t.DNE(0,se,8,6,"mat-card",0),2&s&&t.Y8G("ngIf",0!==i.aggregation.length)},dependencies:[v.YU,v.Sq,v.bT,K.RN],styles:[".long-list[_ngcontent-%COMP%]{max-height:300px;overflow-y:scroll;overflow-x:auto}.item[_ngcontent-%COMP%]{padding:.75rem 1.25rem;cursor:pointer;font-size:14px;border-bottom:1px solid rgba(0,0,0,.125)}.mat-card[_ngcontent-%COMP%]{margin-bottom:20px;padding:0}.filter-header[_ngcontent-%COMP%]{background-color:#dcedf5;color:#577c95;cursor:default}.filter-header[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{cursor:pointer}.active[_ngcontent-%COMP%]{background-color:#477aaf;color:#fff}.active[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{background-color:#fff;color:#477aaf}h6[_ngcontent-%COMP%]{font-size:14px}.badge-secondary[_ngcontent-%COMP%]{background-color:#dcedf5;color:#000;width:4em;padding:.4em .6em;border-radius:7px}.filter-card[_ngcontent-%COMP%]{margin-top:15px}\n\n/*# sourceMappingURL=filter.component.css.map*/"]})}function ie(a,e){if(1&a){const s=t.RV6();t.qex(0),t.j41(1,"button",1),t.bIt("click",function(){const r=t.eBV(s).$implicit,n=t.XpG();return t.Njj(n.clearFilter(r))}),t.j41(2,"div",2)(3,"div"),t.EFF(4),t.k0s(),t.j41(5,"i",3),t.EFF(6,"highlight_off"),t.k0s()()(),t.bVm()}if(2&a){const s=e.$implicit;t.R7$(4),t.JRh(s)}}class H{constructor(e){this.aggregationService=e,this.aggs=[],this.data={}}ngOnInit(){this.aggs=this.aggregationService.current_active_filters,this.data=this.aggregationService.active_filters,this.aggregationService.field.subscribe(e=>{this.aggs=this.aggregationService.current_active_filters,this.data=this.aggregationService.active_filters})}clearFilter(e){const s=this.aggregationService.current_active_filters.indexOf(e);this.aggregationService.current_active_filters.splice(s,1);for(const i of Object.keys(this.data)){const r=this.data[i].indexOf(e);r>-1&&this.data[i].splice(r,1)}this.aggregationService.field.next(this.data)}static#t=this.\u0275fac=function(s){return new(s||H)(t.rXU(x))};static#e=this.\u0275cmp=t.VBU({type:H,selectors:[["app-active-filter"]],decls:1,vars:1,consts:[[4,"ngFor","ngForOf"],["mat-raised-button","",1,"filter-button",3,"click"],[2,"display","flex","align-items","center"],[1,"material-icons"]],template:function(s,i){1&s&&t.DNE(0,ie,7,1,"ng-container",0),2&s&&t.Y8G("ngForOf",i.aggs)},dependencies:[v.Sq,T.$z],styles:[".filter-button[_ngcontent-%COMP%]{margin-left:5px;font-size:14px;background-color:#477aaf;color:#fff}i[_ngcontent-%COMP%]{margin-left:5px}\n\n/*# sourceMappingURL=active-filter.component.css.map*/"]})}const re=["bioSampleIdTemplate"],oe=["paperPublishedTemplate"];function ae(a,e){1&a&&t.nrm(0,"app-active-filter")}function ne(a,e){if(1&a){const s=t.RV6();t.j41(0,"div"),t.DNE(1,ae,1,0,"app-active-filter",12),t.j41(2,"button",17),t.bIt("click",function(){t.eBV(s);const r=t.XpG();return t.Njj(r.removeFilter())}),t.EFF(3,"Remove all filters"),t.k0s(),t.j41(4,"button",18),t.bIt("click",function(){t.eBV(s);const r=t.XpG();return t.Njj(r.openSubscriptionDialog())}),t.j41(5,"div",19)(6,"mat-icon"),t.EFF(7,"email"),t.k0s()()(),t.nrm(8,"hr"),t.k0s()}if(2&a){const s=t.XpG();t.R7$(),t.Y8G("ngIf",s.hasActiveFilters())}}function ce(a,e){if(1&a){const s=t.RV6();t.j41(0,"button",17),t.bIt("click",function(){t.eBV(s);const r=t.XpG();return t.Njj(r.downloadFile("csv"))}),t.EFF(1," Export as CSV file "),t.k0s()}}function le(a,e){if(1&a){const s=t.RV6();t.j41(0,"button",17),t.bIt("click",function(){t.eBV(s);const r=t.XpG();return t.Njj(r.downloadFile("txt"))}),t.EFF(1," Export as Tabular file "),t.k0s()}}function pe(a,e){1&a&&(t.j41(0,"div",20),t.nrm(1,"mat-spinner",21),t.k0s()),2&a&&(t.R7$(),t.Y8G("diameter",30))}function ue(a,e){1&a&&t.EFF(0," Koosum\n")}function he(a,e){if(1&a&&(t.j41(0,"td",23)(1,"i",24),t.EFF(2,"check_circle"),t.k0s()()),2&a){const s=t.XpG().$implicit,i=t.XpG();t.Y8G("ngClass",i.isGreen(s.paperPublished))}}function ge(a,e){if(1&a&&(t.j41(0,"td",23)(1,"i",24),t.EFF(2,"highlight_off"),t.k0s()()),2&a){const s=t.XpG().$implicit,i=t.XpG();t.Y8G("ngClass",i.isGreen(s.paperPublished))}}function me(a,e){if(1&a&&t.DNE(0,he,3,1,"td",22)(1,ge,3,1,"td",22),2&a){const s=e.$implicit,i=t.XpG();t.Y8G("ngIf",i.wasPublished(s.paperPublished)),t.R7$(),t.Y8G("ngIf",!i.wasPublished(s.paperPublished))}}class B{constructor(e,s,i,r,n,o,p,u){this.dataService=e,this.filterStateService=s,this.activatedRoute=i,this.router=r,this.dialog=n,this.dialogModel=o,this.aggregationService=p,this.titleService=u,this.columnNames=["BioSample ID","Sex","Organism","Breed","Standard","Paper published","Subscribe"],this.displayFields=["bioSampleId","sex","organism","breed","standard","paperPublished","subscribe"],this.downloadData=!1,this.downloading=!1,this.data={},this.subscriber={email:"",title:"",indexName:"",indexKey:""},this.query={sort:["id_number","desc"],_source:["biosampleId","sex.text","organism.text","breed.text","standardMet","id_number","paperPublished"],search:""},this.downloadQuery={sort:["id_number","desc"],_source:["_source.biosampleId","_source.sex.text","_source.organism.text","_source.breed.text","_source.standardMet","_source.paperPublished"],columns:this.columnNames,filters:{},file_format:"csv"},this.defaultSort=["id_number","desc"]}ngOnInit(){this.indexDetails={index:"organism",indexKey:"biosampleId",apiKey:"bioSampleId"},this.templates={bioSampleId:this.bioSampleIdTemplate,paperPublished:this.paperPublishedTemplate},this.loadTableDataFunction=this.dataService.getAllOrganisms.bind(this.dataService),this.titleService.setTitle("FAANG organisms"),this.activatedRoute.queryParams.subscribe(e=>{this.filterStateService.resetFilter(),this.loadInitialPageState(e)}),this.tableServerComponent.dataUpdate.subscribe(e=>{this.aggregationService.getAggregations(e.aggregations,"organism")}),this.tableServerComponent.sortUpdate.subscribe(e=>{this.downloadQuery.sort=e}),this.aggrSubscription=this.filterStateService.updateUrlParams(this.query,["organism"])}hasActiveFilters(){if(typeof this.filter_field>"u")return!1;for(const e of Object.keys(this.filter_field))if(0!==this.filter_field[e].length)return!0;return!1}removeFilter(){this.filterStateService.resetFilter(),this.filter_field={},this.router.navigate(["organism"],{queryParams:{},replaceUrl:!0,skipLocationChange:!1})}onDownloadData(){this.downloadData=!this.downloadData}downloadFile(e){this.downloadData=!this.downloadData,this.downloading=!0,this.downloadQuery.file_format=e;this.dataService.downloadRecords("organism",{bioSampleId:"biosampleId",sex:"sex.text",organism:"organism.text",breed:"breed.text",standard:"standardMet",paper_published:"paperPublished"},this.downloadQuery).subscribe(i=>{var r=document.createElement("a");r.href=URL.createObjectURL(i),r.download="faang_data."+e,r.click(),this.downloading=!1})}wasPublished(e){return"true"===e}isGreen(e){return"true"===e?"green":"default"}ngOnDestroy(){typeof this.filter_field<"u"&&this.filterStateService.resetFilter(),this.aggrSubscription.unsubscribe()}openSubscriptionDialog(){this.subscriber.title="Subscribing to filtered Organism entries",this.subscriber.indexName=this.indexDetails.index,this.subscriber.indexKey=this.indexDetails.indexKey;this.dialogModel.open(Y,{height:"300px",width:"400px",data:this.subscriber})}loadInitialPageState(e){const s=this.filterStateService.setUpAggregationFilters(e);this.filter_field=s,this.query.filters=s,this.downloadQuery.filters=s,e.searchTerm&&(this.query.search=e.searchTerm),e.sortTerm&&e.sortDirection&&(this.query.sort=[e.sortTerm,e.sortDirection])}static#t=this.\u0275fac=function(s){return new(s||B)(t.rXU(k),t.rXU(L),t.rXU(S.nX),t.rXU(S.Ix),t.rXU(y.bZ),t.rXU(y.bZ),t.rXU(x),t.rXU(P.hE))};static#e=this.\u0275cmp=t.VBU({type:B,selectors:[["app-organism"]],viewQuery:function(s,i){if(1&s&&(t.GBs(re,7),t.GBs(oe,7),t.GBs(R,7)),2&s){let r;t.mGM(r=t.lsd())&&(i.bioSampleIdTemplate=r.first),t.mGM(r=t.lsd())&&(i.paperPublishedTemplate=r.first),t.mGM(r=t.lsd())&&(i.tableServerComponent=r.first)}},decls:25,vars:19,consts:[["bioSampleIdTemplate",""],["paperPublishedTemplate",""],[1,"container-fluid"],["fxLayoutGap","2%","fxLayout","row","fxLayout.lt-md","column"],["fxFlex","17"],["title","Standard",3,"filterSize"],["title","Sex",3,"filterSize"],["title","Organism",3,"filterSize"],["title","Breed",3,"filterSize"],["title","Paper published",3,"filterSize"],["title","Project",3,"filterSize"],["fxFlex","83",1,"table-responsive"],[4,"ngIf"],["mat-raised-button","",2,"background-color","green","color","white",3,"click","disabled"],["mat-raised-button","",3,"click",4,"ngIf"],["style","padding: 15px",4,"ngIf"],[3,"display_fields","column_names","indexDetails","templates","filter_values","apiFunction","query","defaultSort"],["mat-raised-button","",3,"click"],["mat-raised-button","","matTooltip","Subscribe to selected Organism entries",3,"click"],[1,"subscription-icon"],[2,"padding","15px"],[3,"diameter"],[3,"ngClass",4,"ngIf"],[3,"ngClass"],[1,"material-icons"]],template:function(s,i){if(1&s){const r=t.RV6();t.nrm(0,"app-header"),t.j41(1,"div",2)(2,"h2"),t.EFF(3,"FAANG Organisms"),t.k0s(),t.nrm(4,"hr"),t.j41(5,"div",3)(6,"div",4),t.nrm(7,"app-filter",5)(8,"app-filter",6)(9,"app-filter",7)(10,"app-filter",8)(11,"app-filter",9)(12,"app-filter",10),t.k0s(),t.j41(13,"div",11),t.DNE(14,ne,9,1,"div",12),t.j41(15,"button",13),t.bIt("click",function(){return t.eBV(r),t.Njj(i.onDownloadData())}),t.EFF(16," Download data "),t.k0s(),t.DNE(17,ce,2,0,"button",14)(18,le,2,0,"button",14)(19,pe,2,1,"div",15),t.nrm(20,"app-table-server-side",16),t.k0s()()(),t.DNE(21,ue,1,0,"ng-template",null,0,t.C5r)(23,me,2,2,"ng-template",null,1,t.C5r)}2&s&&(t.R7$(7),t.Y8G("filterSize",6),t.R7$(),t.Y8G("filterSize",2),t.R7$(),t.Y8G("filterSize",3),t.R7$(),t.Y8G("filterSize",3),t.R7$(),t.Y8G("filterSize",2),t.R7$(),t.Y8G("filterSize",4),t.R7$(2),t.Y8G("ngIf",i.hasActiveFilters()),t.R7$(),t.Y8G("disabled",i.downloading),t.R7$(2),t.Y8G("ngIf",i.downloadData),t.R7$(),t.Y8G("ngIf",i.downloadData),t.R7$(),t.Y8G("ngIf",i.downloading),t.R7$(),t.Y8G("display_fields",i.displayFields)("column_names",i.columnNames)("indexDetails",i.indexDetails)("templates",i.templates)("filter_values",i.filter_field)("apiFunction",i.loadTableDataFunction)("query",i.query)("defaultSort",i.defaultSort))},dependencies:[v.YU,v.bT,gt.oV,T.$z,I.An,mt.LG,V,H,O,R],styles:[".unsorted[_ngcontent-%COMP%]{color:#d3d3d3}.clickable[_ngcontent-%COMP%]{cursor:pointer}@media (max-width: 767px){div.faang-filter[_ngcontent-%COMP%]{width:300px;max-width:100%;margin-left:auto;margin-right:auto}}button[_ngcontent-%COMP%]{margin-left:5px}.green[_ngcontent-%COMP%]{color:green;text-align:center;width:100px}.default[_ngcontent-%COMP%]{text-align:center;width:100px}a[_ngcontent-%COMP%]{color:#4682b4}table[_ngcontent-%COMP%]{font-size:14px}h3[_ngcontent-%COMP%]{color:#477aaf}.subscription-icon[_ngcontent-%COMP%]{color:#4682b4;display:flex;align-items:center}\n\n/*# sourceMappingURL=organism.component.css.map*/"]})}const de=[{path:"",redirectTo:"home",pathMatch:"full"},{path:"home",component:M},{path:"organism",component:B}];class W{static#t=this.\u0275fac=function(s){return new(s||W)};static#e=this.\u0275mod=t.$C({type:W});static#s=this.\u0275inj=t.G2t({imports:[S.iI.forRoot(de),S.iI]})}var fe=f(2552),_e=f(2329),be=f(3804),ve=f(8223),Se=f(3347),Fe=f(5175),ye=f(8736),xe=f(943);class X{static#t=this.\u0275fac=function(s){return new(s||X)};static#e=this.\u0275mod=t.$C({type:X,bootstrap:[G]});static#s=this.\u0275inj=t.G2t({providers:[k,x,E,(0,_.$R)((0,_.Sx)()),(0,P.$x)()],imports:[P.Bb,W,J.PO,fe.wb,b.YN,F.tP,Q.Ou,z.NQ,gt.uc,T.Hl,I.m_,tt.fS,be.Wk,y.hM,ve.RI,Se._T,mt.D6,Fe.Ve,b.X1,j.RG,D.Cn,K.Hu,at.s5,ye.jH,ot.w,_e.WJ.register("ngsw-worker.js",{enabled:w_production}),rt.nF.forRoot(dt),xe.Fg]})}w_production&&(0,t.SmG)(),P.sG().bootstrapModule(X).catch(a=>console.log(a))}},C=>{C.O(0,["vendor"],()=>{return P=3823,C(C.s=P);var P});C.O()}]);
//# sourceMappingURL=main.js.map